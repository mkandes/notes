# Modifying ZFS configuration
- Limit ARC to max 50% RAM
- Enable snapshots

```
mkandes@hardtack:~$ zfs list
NAME                                               USED  AVAIL  REFER  MOUNTPOINT
bpool                                              213M  1.54G    96K  /boot
bpool/BOOT                                         211M  1.54G    96K  none
bpool/BOOT/ubuntu_ybsehk                           211M  1.54G   211M  /boot
rpool                                             1.49T   306G   192K  /
rpool/ROOT                                        22.1G   306G   192K  none
rpool/ROOT/ubuntu_ybsehk                          22.1G   306G  13.5G  /
rpool/ROOT/ubuntu_ybsehk/srv                       192K   306G   192K  /srv
rpool/ROOT/ubuntu_ybsehk/usr                       664K   306G   192K  /usr
rpool/ROOT/ubuntu_ybsehk/usr/local                 472K   306G   472K  /usr/local
rpool/ROOT/ubuntu_ybsehk/var                      8.59G   306G   192K  /var
rpool/ROOT/ubuntu_ybsehk/var/games                 192K   306G   192K  /var/games
rpool/ROOT/ubuntu_ybsehk/var/lib                  8.47G   306G  8.29G  /var/lib
rpool/ROOT/ubuntu_ybsehk/var/lib/AccountsService   212K   306G   212K  /var/lib/AccountsService
rpool/ROOT/ubuntu_ybsehk/var/lib/NetworkManager    684K   306G   684K  /var/lib/NetworkManager
rpool/ROOT/ubuntu_ybsehk/var/lib/apt               101M   306G   101M  /var/lib/apt
rpool/ROOT/ubuntu_ybsehk/var/lib/dpkg             84.0M   306G  84.0M  /var/lib/dpkg
rpool/ROOT/ubuntu_ybsehk/var/log                   118M   306G   118M  /var/log
rpool/ROOT/ubuntu_ybsehk/var/mail                  192K   306G   192K  /var/mail
rpool/ROOT/ubuntu_ybsehk/var/snap                 4.17M   306G  4.17M  /var/snap
rpool/ROOT/ubuntu_ybsehk/var/spool                2.66M   306G  2.66M  /var/spool
rpool/ROOT/ubuntu_ybsehk/var/www                   192K   306G   192K  /var/www
rpool/USERDATA                                    1.47T   306G   192K  none
rpool/USERDATA/home_fdun0v                        1.47T   306G  1.47T  /home
rpool/USERDATA/root_fdun0v                         688K   306G   688K  /root
rpool/keystore                                    22.5M   306G  16.5M  -
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ swapon --show
NAME      TYPE      SIZE USED PRIO
/dev/dm-1 partition   8G 1.5G   -2
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ df -h
Filesystem                                        Size  Used Avail Use% Mounted on
tmpfs                                             3.2G  3.2M  3.2G   1% /run
/dev/mapper/keystore-rpool                        3.8M   28K  3.5M   1% /run/keystore/rpool
rpool/ROOT/ubuntu_ybsehk                          320G   14G  307G   5% /
rpool/ROOT/ubuntu_ybsehk/srv                      307G  256K  307G   1% /srv
rpool/ROOT/ubuntu_ybsehk/usr/local                307G  512K  307G   1% /usr/local
rpool/ROOT/ubuntu_ybsehk/var/games                307G  256K  307G   1% /var/games
rpool/ROOT/ubuntu_ybsehk/var/lib                  315G  8.3G  307G   3% /var/lib
rpool/ROOT/ubuntu_ybsehk/var/lib/AccountsService  307G  256K  307G   1% /var/lib/AccountsService
rpool/ROOT/ubuntu_ybsehk/var/lib/NetworkManager   307G  768K  307G   1% /var/lib/NetworkManager
rpool/ROOT/ubuntu_ybsehk/var/lib/apt              307G  102M  307G   1% /var/lib/apt
rpool/ROOT/ubuntu_ybsehk/var/lib/dpkg             307G   84M  307G   1% /var/lib/dpkg
rpool/ROOT/ubuntu_ybsehk/var/log                  307G  119M  307G   1% /var/log
rpool/ROOT/ubuntu_ybsehk/var/mail                 307G  256K  307G   1% /var/mail
rpool/ROOT/ubuntu_ybsehk/var/snap                 307G  4.3M  307G   1% /var/snap
rpool/ROOT/ubuntu_ybsehk/var/spool                307G  2.8M  307G   1% /var/spool
rpool/ROOT/ubuntu_ybsehk/var/www                  307G  256K  307G   1% /var/www
tmpfs                                              16G  246M   16G   2% /dev/shm
tmpfs                                             5.0M   16K  5.0M   1% /run/lock
efivarfs                                          374K  290K   80K  79% /sys/firmware/efi/efivars
rpool/USERDATA/home_fdun0v                        1.8T  1.5T  307G  84% /home
rpool/USERDATA/root_fdun0v                        307G  768K  307G   1% /root
tmpfs                                              16G     0   16G   0% /run/qemu
bpool/BOOT/ubuntu_ybsehk                          1.8G  211M  1.6G  12% /boot
/dev/nvme0n1p1                                    1.1G   34M  1.1G   4% /boot/efi
tmpfs                                             3.2G  164K  3.2G   1% /run/user/1000
/dev/sda1                                         117G   14M  117G   1% /media/mkandes/Secure_Key
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ cat /etc/fstab | grep swap
/dev/disk/by-id/dm-uuid-CRYPT-PLAIN-dm_crypt-0 none swap sw 0 0
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ sudo -i
[sudo] password for mkandes: 
root@hardtack:~# cd /etc/modprobe.d/
root@hardtack:/etc/modprobe.d# ls
alsa-base.conf                  blacklist-modem.conf
amd64-microcode-blacklist.conf  blacklist-oss.conf
blacklist-ath_pci.conf          blacklist-rare-network.conf
blacklist.conf                  intel-microcode-blacklist.conf
blacklist-firewire.conf         iwlwifi.conf
blacklist-framebuffer.conf
root@hardtack:/etc/modprobe.d#
```

# Reference(s):
- https://github.com/openzfs/zfs/issues/17052
- https://blog.thalheim.io/2025/10/17/zfs-ate-my-ram-understanding-the-arc-cache
- https://www.linuxatemyram.com
- https://ubuntu.com/tutorials/using-zfs-snapshots-clones
