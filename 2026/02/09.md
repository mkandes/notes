# Setup ZFS snapshots

```
mkandes@hardtack:~$ zfs list -t snapshot
no datasets available
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ zfs list
NAME                                               USED  AVAIL  REFER  MOUNTPOINT
bpool                                              217M  1.54G    96K  /boot
bpool/BOOT                                         216M  1.54G    96K  none
bpool/BOOT/ubuntu_ybsehk                           216M  1.54G   216M  /boot
rpool                                              613G  1.19T   192K  /
rpool/ROOT                                        21.8G  1.19T   192K  none
rpool/ROOT/ubuntu_ybsehk                          21.8G  1.19T  13.2G  /
rpool/ROOT/ubuntu_ybsehk/srv                       192K  1.19T   192K  /srv
rpool/ROOT/ubuntu_ybsehk/usr                       664K  1.19T   192K  /usr
rpool/ROOT/ubuntu_ybsehk/usr/local                 472K  1.19T   472K  /usr/local
rpool/ROOT/ubuntu_ybsehk/var                      8.60G  1.19T   192K  /var
rpool/ROOT/ubuntu_ybsehk/var/games                 192K  1.19T   192K  /var/games
rpool/ROOT/ubuntu_ybsehk/var/lib                  8.47G  1.19T  8.29G  /var/lib
rpool/ROOT/ubuntu_ybsehk/var/lib/AccountsService   212K  1.19T   212K  /var/lib/AccountsService
rpool/ROOT/ubuntu_ybsehk/var/lib/NetworkManager    684K  1.19T   684K  /var/lib/NetworkManager
rpool/ROOT/ubuntu_ybsehk/var/lib/apt               101M  1.19T   101M  /var/lib/apt
rpool/ROOT/ubuntu_ybsehk/var/lib/dpkg             84.5M  1.19T  84.5M  /var/lib/dpkg
rpool/ROOT/ubuntu_ybsehk/var/log                   121M  1.19T   121M  /var/log
rpool/ROOT/ubuntu_ybsehk/var/mail                  192K  1.19T   192K  /var/mail
rpool/ROOT/ubuntu_ybsehk/var/snap                 4.17M  1.19T  4.17M  /var/snap
rpool/ROOT/ubuntu_ybsehk/var/spool                2.80M  1.19T  2.80M  /var/spool
rpool/ROOT/ubuntu_ybsehk/var/www                   192K  1.19T   192K  /var/www
rpool/USERDATA                                     591G  1.19T   192K  none
rpool/USERDATA/home_fdun0v                         591G  1.19T   591G  /home
rpool/USERDATA/root_fdun0v                         688K  1.19T   688K  /root
rpool/keystore                                    22.5M  1.19T  16.5M  -
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ sudo zfs allow mkandes snapshot rpool/USERDATA/home_fdun0v
[sudo] password for mkandes: 
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ zfs allow rpool/USERDATA/home_fdun0v
---- Permissions on rpool/USERDATA/home_fdun0v -----------------------
Local+Descendent permissions:
	user mkandes snapshot
mkandes@hardtack:~$
```

```
mkandes@hardtack:~$ zfs snapshot rpool/USERDATA/home_fdun0v@snapshot-$(date -u +'%Y%m%dT%H%M%S')
mkandes@hardtack:~$ zfs list -t snapshot
NAME                                                  USED  AVAIL  REFER  MOUNTPOINT
rpool/USERDATA/home_fdun0v@snapshot-20260210T035238   700K      -   591G  -
mkandes@hardtack:~$
```

# Reference(s):
- https://www.dwarmstrong.org/zfs-snapshots/
- https://klarasystems.com/articles/basics-of-zfs-snapshot-management/
- https://klarasystems.com/articles/introduction-to-zfs-replication/
- https://ubuntu.com/tutorials/using-zfs-snapshots-clones#1-overview
- https://docs.oracle.com/cd/E23824_01/html/821-1448/gavvx.html
