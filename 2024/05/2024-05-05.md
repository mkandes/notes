# [AraRAN Experiments](https://arawireless.readthedocs.io/en/latest/ara_experiments/ara_ran_experiments.html#araran-experiments)

### Experiment #1: Transmitting, Receiving, and Visualizing Waveforms using UHD and GNURadio

- Sandbox-Host-001
  - nrUE_host
  - nrUE_container
  - Port IP address: 10.0.4.216
  - Floating IP address: 10.189.11.210
 
- Sandbox-Host-002
  - gNB_host
  - gnB_container
  - Port IP address: 10.0.4.20
  - Floating IP address: 10.189.11.155


From the Horizon Container Console, update the software inside the container and then set a password for the root user. Once set, restart SSH to enable login from the ARA jumpbox. 
```
apt-get -y update && apt-get -y upgrade
apt-get -y install vim
passwd
service ssh restart
```

```
mkandes@hardtack:~$ ssh ara
mckandes@ara-jbox:~$ ssh root@10.189.11.210
The authenticity of host '10.189.11.210 (10.189.11.210)' can't be established.
ECDSA key fingerprint is SHA256:KfjMVWr5PmHIZq+xXc6rsfVxuXkDeJHs0mRRk5bsckU.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.189.11.210' (ECDSA) to the list of known hosts.
root@10.189.11.210's password: 
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.19.17-051917-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Sun Apr 14 16:14:20 2024 from 10.65.252.140
root@nrUE_host:~#
```

```
root@nrUE_host:~# lscpu
Architecture:            x86_64
  CPU op-mode(s):        32-bit, 64-bit
  Address sizes:         39 bits physical, 48 bits virtual
  Byte Order:            Little Endian
CPU(s):                  16
  On-line CPU(s) list:   0-15
Vendor ID:               GenuineIntel
  Model name:            13th Gen Intel(R) Core(TM) i7-1360P
    CPU family:          6
    Model:               186
    Thread(s) per core:  2
    Core(s) per socket:  12
    Socket(s):           1
    Stepping:            2
    CPU max MHz:         5000.0000
    CPU min MHz:         400.0000
    BogoMIPS:            5222.40
    Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mc
                         a cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss 
                         ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art
                          arch_perfmon pebs bts rep_good nopl xtopology nonstop_
                         tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes6
                         4 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xt
                         pr pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_dead
                         line_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowp
                         refetch cpuid_fault epb invpcid_single ssbd ibrs ibpb s
                         tibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpi
                         d ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms i
                         nvpcid rdseed adx smap clflushopt clwb intel_pt sha_ni 
                         xsaveopt xsavec xgetbv1 xsaves avx_vnni dtherm ida arat
                          pln pts hwp hwp_notify hwp_act_window hwp_epp hwp_pkg_
                         req hfi umip pku ospke waitpkg gfni vaes vpclmulqdq rdp
                         id movdiri movdir64b fsrm md_clear serialize arch_lbr i
                         bt flush_l1d arch_capabilities
Virtualization features: 
  Virtualization:        VT-x
Caches (sum of all):     
  L1d:                   448 KiB (12 instances)
  L1i:                   640 KiB (12 instances)
  L2:                    9 MiB (6 instances)
  L3:                    18 MiB (1 instance)
NUMA:                    
  NUMA node(s):          1
  NUMA node0 CPU(s):     0-15
Vulnerabilities:         
  Itlb multihit:         Not affected
  L1tf:                  Not affected
  Mds:                   Not affected
  Meltdown:              Not affected
  Mmio stale data:       Not affected
  Retbleed:              Not affected
  Spec store bypass:     Mitigation; Speculative Store Bypass disabled via prctl
  Spectre v1:            Mitigation; usercopy/swapgs barriers and __user pointer
                          sanitization
  Spectre v2:            Mitigation; Enhanced IBRS, IBPB conditional, RSB fillin
                         g, PBRSB-eIBRS SW sequence
  Srbds:                 Not affected
  Tsx async abort:       Not affected
root@nrUE_host:~#
```

https://ark.intel.com/content/www/us/en/ark/products/232155/intel-core-i7-1360p-processor-18m-cache-up-to-5-00-ghz.html

```
mkandes@hardtack:~$ ssh ara
mckandes@ara-jbox:~$ ssh root@10.189.11.155
The authenticity of host '10.189.11.155 (10.189.11.155)' can't be established.
ECDSA key fingerprint is SHA256:KfjMVWr5PmHIZq+xXc6rsfVxuXkDeJHs0mRRk5bsckU.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.189.11.155' (ECDSA) to the list of known hosts.
root@10.189.11.155's password: 
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.19.17-051917-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Sun Apr 14 16:14:39 2024 from 10.65.252.140
root@gNB_host:~#
```
```
root@gNB_host:~# lscpu
Architecture:            x86_64
  CPU op-mode(s):        32-bit, 64-bit
  Address sizes:         39 bits physical, 48 bits virtual
  Byte Order:            Little Endian
CPU(s):                  16
  On-line CPU(s) list:   0-15
Vendor ID:               GenuineIntel
  Model name:            13th Gen Intel(R) Core(TM) i7-1360P
    CPU family:          6
    Model:               186
    Thread(s) per core:  2
    Core(s) per socket:  12
    Socket(s):           1
    Stepping:            2
    CPU max MHz:         5000.0000
    CPU min MHz:         400.0000
    BogoMIPS:            5222.40
    Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mc
                         a cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss 
                         ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art
                          arch_perfmon pebs bts rep_good nopl xtopology nonstop_
                         tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes6
                         4 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xt
                         pr pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_dead
                         line_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowp
                         refetch cpuid_fault epb invpcid_single ssbd ibrs ibpb s
                         tibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpi
                         d ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms i
                         nvpcid rdseed adx smap clflushopt clwb intel_pt sha_ni 
                         xsaveopt xsavec xgetbv1 xsaves avx_vnni dtherm ida arat
                          pln pts hwp hwp_notify hwp_act_window hwp_epp hwp_pkg_
                         req hfi umip pku ospke waitpkg gfni vaes vpclmulqdq rdp
                         id movdiri movdir64b fsrm md_clear serialize arch_lbr i
                         bt flush_l1d arch_capabilities
Virtualization features: 
  Virtualization:        VT-x
Caches (sum of all):     
  L1d:                   448 KiB (12 instances)
  L1i:                   640 KiB (12 instances)
  L2:                    9 MiB (6 instances)
  L3:                    18 MiB (1 instance)
NUMA:                    
  NUMA node(s):          1
  NUMA node0 CPU(s):     0-15
Vulnerabilities:         
  Itlb multihit:         Not affected
  L1tf:                  Not affected
  Mds:                   Not affected
  Meltdown:              Not affected
  Mmio stale data:       Not affected
  Retbleed:              Not affected
  Spec store bypass:     Mitigation; Speculative Store Bypass disabled via prctl
  Spectre v1:            Mitigation; usercopy/swapgs barriers and __user pointer
                          sanitization
  Spectre v2:            Mitigation; Enhanced IBRS, IBPB conditional, RSB fillin
                         g, PBRSB-eIBRS SW sequence
  Srbds:                 Not affected
  Tsx async abort:       Not affected
root@gNB_host:~#
```

```
root@gNB_host:/usr/local/lib/uhd/examples# ls
benchmark_rate  rfnoc_nullsource_ce_rx          rx_samples_c        sync_to_gps           test_timed_commands   tx_waveforms
gpio            rfnoc_radio_loopback            rx_samples_to_file  test_clock_synch      tx_bursts             txrx_loopback_to_file
latency_test    rfnoc_replay_samples_from_file  rx_samples_to_udp   test_dboard_coercion  tx_samples_c          usrp_list_sensors
network_relay   rfnoc_rx_to_file                rx_timed_samples    test_messages         tx_samples_from_file
python          rx_multi_samples                spi                 test_pps_input        tx_timed_samples
root@gNB_host:/usr/local/lib/uhd/examples# ./tx_waveforms --freq 3586.08e6 --rate 5e6 --gain 70

Creating the usrp device with: ...
[INFO] [UHD] linux; GNU C++ version 11.3.0; Boost_107400; UHD_4.4.0.HEAD-0-g5fac246b
[INFO] [B200] Detected Device: B210
[INFO] [B200] Operating over USB 3.
[INFO] [B200] Initialize CODEC control...
[INFO] [B200] Initialize Radio control...
[INFO] [B200] Performing register loopback test... 
[INFO] [B200] Register loopback test passed
[INFO] [B200] Performing register loopback test... 
[INFO] [B200] Register loopback test passed
[INFO] [B200] Setting master clock rate selection to 'automatic'.
[INFO] [B200] Asking for clock rate 16.000000 MHz... 
[INFO] [B200] Actually got clock rate 16.000000 MHz.
Using Device: Single USRP:
  Device: B-Series Device
  Mboard 0: B210
  RX Channel: 0
    RX DSP: 0
    RX Dboard: A
    RX Subdev: FE-RX2
  RX Channel: 1
    RX DSP: 1
    RX Dboard: A
    RX Subdev: FE-RX1
  TX Channel: 0
    TX DSP: 0
    TX Dboard: A
    TX Subdev: FE-TX2
  TX Channel: 1
    TX DSP: 1
    TX Dboard: A
    TX Subdev: FE-TX1

Setting TX Rate: 5.000000 Msps...
[INFO] [B200] Asking for clock rate 40.000000 MHz... 
[INFO] [B200] Actually got clock rate 40.000000 MHz.
Actual TX Rate: 5.000000 Msps...

Setting TX Freq: 3586.080000 MHz...
Setting TX LO Offset: 0.000000 MHz...
Actual TX Freq: 3586.080000 MHz...

Setting TX Gain: 70.000000 dB...
Actual TX Gain: 70.000000 dB...

Setting device timestamp to 0...
Checking TX: LO: locked ...
Press Ctrl + C to stop streaming...
```

```
root@nrUE_host:/usr/local/lib/uhd/examples# ls
benchmark_rate  rfnoc_nullsource_ce_rx          rx_multi_samples    spi                   test_pps_input        tx_timed_samples
gpio            rfnoc_radio_loopback            rx_samples_c        sync_to_gps           test_timed_commands   tx_waveforms
latency_test    rfnoc_replay_samples_from_file  rx_samples_to_file  test_clock_synch      tx_bursts             txrx_loopback_to_file
network_relay   rfnoc_rx_to_file                rx_samples_to_udp   test_dboard_coercion  tx_samples_c          usrp_list_sensors
python          rx_ascii_art_dft                rx_timed_samples    test_messages         tx_samples_from_file
root@nrUE_host:/usr/local/lib/uhd/examples# ./rx_ascii_art_dft --freq 3586.08e6 --rate 1e6 --gain 40 --ref-lvl -60

Creating the usrp device with: ...
[INFO] [UHD] linux; GNU C++ version 11.3.0; Boost_107400; UHD_4.4.0.HEAD-0-g5fac246b
[INFO] [B200] Detected Device: B210
[INFO] [B200] Operating over USB 3.
[INFO] [B200] Initialize CODEC control...
[INFO] [B200] Initialize Radio control...
[INFO] [B200] Performing register loopback test... 
[INFO] [B200] Register loopback test passed
[INFO] [B200] Performing register loopback test... 
[INFO] [B200] Register loopback test passed
[INFO] [B200] Setting master clock rate selection to 'automatic'.
[INFO] [B200] Asking for clock rate 16.000000 MHz... 
[INFO] [B200] Actually got clock rate 16.000000 MHz.
Using Device: Single USRP:
  Device: B-Series Device
  Mboard 0: B210
  RX Channel: 0
    RX DSP: 0
    RX Dboard: A
    RX Subdev: FE-RX2
  RX Channel: 1
    RX DSP: 1
    RX Dboard: A
    RX Subdev: FE-RX1
  TX Channel: 0
    TX DSP: 0
    TX Dboard: A
    TX Subdev: FE-TX2
  TX Channel: 1
    TX DSP: 1
    TX Dboard: A
    TX Subdev: FE-TX1

Setting RX Rate: 1.000000 Msps...
[INFO] [B200] Asking for clock rate 32.000000 MHz... 
[INFO] [B200] Actually got clock rate 32.000000 MHz.
Actual RX Rate: 1.000000 Msps...

Setting RX Freq: 3586.080000 MHz...
Actual RX Freq: 3586.080000 MHz...

Setting RX Gain: 40.000000 dB...
Actual RX Gain: 40.000000 dB...

Checking RX: LO: locked ...
root@nrUE_host:/usr/local/lib/uhd/examples#
```

```
heat_template_version: '2015-04-30'
resources:
  lease_0:
    type: OS::Blazar::Lease
    properties:
      start_date: ''
      end_date: ''
      name: mckandes_araran_exp_1_gNB
      reservations:
      - resource_properties:
        - Site: Sandbox
          Resource_Type: AraRAN
          Device_Type: Host
          Device_ID: '002'
  lease_1:
    type: OS::Blazar::Lease
    properties:
      start_date: ''
      end_date: ''
      name: mckandes_araran_exp_1_UE
      reservations:
      - resource_properties:
        - Site: Sandbox
          Resource_Type: AraRAN
          Device_Type: Host
          Device_ID: '001'
  container_0:
    type: OS::Zun::Container
    depends_on: &id001
    - lease_0
    - lease_1
    properties:
      command: /bin/bash
      cpu: 2.0
      memory: '5120'
      image: arawirelesshub/openairinterface5g:oai_nrue
      name: nrUE_container
      hints:
        host_name: Sandbox-Host-001
      networks:
      - network: ARA_Shared_Net
  container_1:
    type: OS::Zun::Container
    depends_on: *id001
    properties:
      command: /bin/bash
      cpu: 2.0
      memory: '5120'
      image: arawirelesshub/openairinterface5g:oai_gnb
      name: gnB_container
      hints:
        host_name: Sandbox-Host-002
      networks:
      - network: ARA_Shared_Net
```

### Experiment #2: Monitoring AraMIMO Wireless Link Behavior using CLI

DataCenter-Compute-000
- data_center_compute_000_host
- data_center_compute_000_container
- Port IP address: 10.0.4.121
- Floating IP address: 10.189.10.176


```
sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/sshd/sshd_config
```

```
mckandes@ara-jbox:~$ ssh root@10.189.10.176
root@10.189.10.176's password: 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-149-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@data_center_compute_000_container:~#
```

```
root@data_center_compute_000_container:~# lscpu
Architecture:                    x86_64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   46 bits physical, 57 bits virtual
CPU(s):                          64
On-line CPU(s) list:             0-63
Thread(s) per core:              2
Core(s) per socket:              16
Socket(s):                       2
NUMA node(s):                    2
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           106
Model name:                      Intel(R) Xeon(R) Gold 6326 CPU @ 2.90GHz
Stepping:                        6
CPU MHz:                         3300.000
BogoMIPS:                        5800.00
Virtualization:                  VT-x
L1d cache:                       1.5 MiB
L1i cache:                       1 MiB
L2 cache:                        40 MiB
L3 cache:                        48 MiB
NUMA node0 CPU(s):               0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):               1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Itlb multihit:     Not affected
Vulnerability L1tf:              Not affected
Vulnerability Mds:               Not affected
Vulnerability Meltdown:          Not affected
Vulnerability Mmio stale data:   Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Retbleed:          Not affected
Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp
Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:        Mitigation; Enhanced IBRS, IBPB conditional, RSB filling, PBRSB-eIBRS SW sequence
Vulnerability Srbds:             Not affected
Vulnerability Tsx async abort:   Not affected
Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma 
                                 cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 invpcid_single ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm 
                                 rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local wbnoinvd dtherm ida arat pln pts avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg
                                  tme avx512_vpopcntdq rdpid md_clear pconfig flush_l1d arch_capabilities
root@data_center_compute_000_container:~#
```
