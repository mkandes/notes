# Testing the feasability of an HTCondor deployment for an ARA demonstration at ARAFest24

Starting with the current version of the `DataCenterCompute-v0.yaml` Heat Orchestration Template, create the Stack. Once the container has startedd running, login via SSH through the ARA Jump Host. Let's start with a central manager configuration using the new `get.htcondor.org` helper script method and investigate the base configration, which uses the pool password method to generate the new token-based approach for security.

*Command*:
```
curl -fsSL https://get.htcondor.org | GET_HTCONDOR_PASSWORD="XXXXXXXXXX" /bin/bash -s -- --no-dry-run --central-manager 10.0.4.242
```

*Output*:
```
root@DataCenterCompute000:~# curl -fsSL https://get.htcondor.org | GET_HTCONDOR_PASSWORD="XXXXXXXXXX" /bin/bash -s -- --no-dry-run --central-manager 10.0.4.242
# Installing HTCondor as central manager for Ubuntu jammy
+ echo -e '\n# Adding our repository'

# Adding our repository
+ apt_get='DEBIAN_FRONTEND=noninteractive apt-get'
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get update'
Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy InRelease
Hit:3 http://archive.ubuntu.com/ubuntu jammy InRelease                      
Hit:4 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:5 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Reading package lists... Done
W: https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y gnupg'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
gnupg is already the newest version (2.2.27-3ubuntu2.1).
gnupg set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ sh -c 'mkdir -p /etc/apt/keyrings'
+ sh -c 'curl -fsSL https://research.cs.wisc.edu/htcondor/repo/keys/HTCondor-current-Key -o /etc/apt/keyrings/HTCondor-current-Key'
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install apt-transport-https'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  apt-transport-https
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 1510 B of archives.
After this operation, 170 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 apt-transport-https all 2.4.12 [1510 B]
Fetched 1510 B in 0s (7390 B/s)               
Selecting previously unselected package apt-transport-https.
(Reading database ... 48156 files and directories currently installed.)
Preparing to unpack .../apt-transport-https_2.4.12_all.deb ...
Unpacking apt-transport-https (2.4.12) ...
Setting up apt-transport-https (2.4.12) ...
NEEDRESTART-VER: 3.5
NEEDRESTART-KCUR: 5.4.0-149-generic
NEEDRESTART-KSTA: 0
NEEDRESTART-UCSTA: 0
+ HTCONDOR_LIST=/etc/apt/sources.list.d/htcondor.list
+ sh -c 'echo "deb [signed-by=/etc/apt/keyrings/HTCondor-current-Key] https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy main" > /etc/apt/sources.list.d/htcondor.list'
+ sh -c 'echo "deb-src [signed-by=/etc/apt/keyrings/HTCondor-current-Key] https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy main" >> /etc/apt/sources.list.d/htcondor.list'
+ echo -e '\n# Updating package lists'

# Updating package lists
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get update'
Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy InRelease
Get:3 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy InRelease [5901 B]
Hit:4 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Get:6 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main Sources [7019 B]
Hit:7 http://archive.ubuntu.com/ubuntu jammy-backports InRelease    
Get:8 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 Packages [82.1 kB]
Fetched 95.0 kB in 1s (188 kB/s)    
Reading package lists... Done
W: https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
+ echo -e '\n# Installing ps'

# Installing ps
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y procps'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
procps is already the newest version (2:3.3.17-6ubuntu2.1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ case $lsb_dist.$dist_version in
+ echo -e '\n# Preconfiguring packages for Ubuntu.'

# Preconfiguring packages for Ubuntu.
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y keyboard-configuration console-setup tzdata'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
console-setup is already the newest version (1.205ubuntu3).
console-setup set to manually installed.
keyboard-configuration is already the newest version (1.205ubuntu3).
keyboard-configuration set to manually installed.
tzdata is already the newest version (2024a-0ubuntu0.22.04.1).
tzdata set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ echo -e '\n# Installing HTCondor binaries and dependencies'

# Installing HTCondor binaries and dependencies
+ [[ ! -n central manager ]]
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y condor'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  condor-upgrade-checks fonts-glyphicons-halflings libboost-python1.74.0 libdate-manip-perl libjs-bootstrap libmunge2
  libpcre2-16-0 libpcre2-32-0 libpcre2-posix3 libscitokens0 libvomsapi1v5 pcre2-utils pelican pelican-osdf-compat
  python3-certifi python3-requests python3-urllib3
Suggested packages:
  docker.io coop-computing-tools singularity-container slurm-client python3-socks python-requests-doc
The following NEW packages will be installed:
  condor condor-upgrade-checks fonts-glyphicons-halflings libboost-python1.74.0 libdate-manip-perl libjs-bootstrap
  libmunge2 libpcre2-16-0 libpcre2-32-0 libpcre2-posix3 libscitokens0 libvomsapi1v5 pcre2-utils pelican
  pelican-osdf-compat python3-certifi python3-requests python3-urllib3
0 upgraded, 18 newly installed, 0 to remove and 0 not upgraded.
Need to get 27.0 MB of archives.
After this operation, 94.5 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 libdate-manip-perl all 6.86-1 [946 kB]
Get:2 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy/main amd64 libscitokens0 amd64 1.1.1-1.1 [123 kB]
Get:3 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 condor-upgrade-checks all 23.9.6-1.1 [42.3 kB]
Get:4 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 condor amd64 23.9.6-1.1 [8524 kB]
Get:5 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 pelican amd64 7.9.9-1 [15.9 MB]
Get:6 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 pelican-osdf-compat amd64 7.9.9-1 [1502 B]
Get:7 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-certifi all 2020.6.20-1 [150 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-urllib3 all 1.26.5-1~exp1ubuntu0.1 [98.2 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-requests all 2.25.1+dfsg-2ubuntu0.1 [48.8 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libmunge2 amd64 0.5.14-6 [15.7 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy/universe amd64 fonts-glyphicons-halflings all 1.009~3.4.1+dfsg-2 [117 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-bootstrap all 3.4.1+dfsg-2 [124 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libvomsapi1v5 amd64 2.1.0~rc2-2 [140 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-16-0 amd64 10.39-3ubuntu0.1 [203 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-32-0 amd64 10.39-3ubuntu0.1 [194 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-posix3 amd64 10.39-3ubuntu0.1 [6130 B]
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 pcre2-utils amd64 10.39-3ubuntu0.1 [128 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy/main amd64 libboost-python1.74.0 amd64 1.74.0-14ubuntu3 [299 kB]
Fetched 27.0 MB in 1s (23.3 MB/s)              
Selecting previously unselected package libdate-manip-perl.
(Reading database ... 48160 files and directories currently installed.)
Preparing to unpack .../00-libdate-manip-perl_6.86-1_all.deb ...
Unpacking libdate-manip-perl (6.86-1) ...
Selecting previously unselected package python3-certifi.
Preparing to unpack .../01-python3-certifi_2020.6.20-1_all.deb ...
Unpacking python3-certifi (2020.6.20-1) ...
Selecting previously unselected package python3-urllib3.
Preparing to unpack .../02-python3-urllib3_1.26.5-1~exp1ubuntu0.1_all.deb ...
Unpacking python3-urllib3 (1.26.5-1~exp1ubuntu0.1) ...
Selecting previously unselected package python3-requests.
Preparing to unpack .../03-python3-requests_2.25.1+dfsg-2ubuntu0.1_all.deb ...
Unpacking python3-requests (2.25.1+dfsg-2ubuntu0.1) ...
Selecting previously unselected package libmunge2.
Preparing to unpack .../04-libmunge2_0.5.14-6_amd64.deb ...
Unpacking libmunge2 (0.5.14-6) ...
Selecting previously unselected package fonts-glyphicons-halflings.
Preparing to unpack .../05-fonts-glyphicons-halflings_1.009~3.4.1+dfsg-2_all.deb ...
Unpacking fonts-glyphicons-halflings (1.009~3.4.1+dfsg-2) ...
Selecting previously unselected package libjs-bootstrap.
Preparing to unpack .../06-libjs-bootstrap_3.4.1+dfsg-2_all.deb ...
Unpacking libjs-bootstrap (3.4.1+dfsg-2) ...
Selecting previously unselected package libscitokens0:amd64.
Preparing to unpack .../07-libscitokens0_1.1.1-1.1_amd64.deb ...
Unpacking libscitokens0:amd64 (1.1.1-1.1) ...
Selecting previously unselected package libvomsapi1v5:amd64.
Preparing to unpack .../08-libvomsapi1v5_2.1.0~rc2-2_amd64.deb ...
Unpacking libvomsapi1v5:amd64 (2.1.0~rc2-2) ...
Selecting previously unselected package libpcre2-16-0:amd64.
Preparing to unpack .../09-libpcre2-16-0_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-16-0:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package libpcre2-32-0:amd64.
Preparing to unpack .../10-libpcre2-32-0_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-32-0:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package libpcre2-posix3:amd64.
Preparing to unpack .../11-libpcre2-posix3_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-posix3:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package pcre2-utils.
Preparing to unpack .../12-pcre2-utils_10.39-3ubuntu0.1_amd64.deb ...
Unpacking pcre2-utils (10.39-3ubuntu0.1) ...
Selecting previously unselected package condor-upgrade-checks.
Preparing to unpack .../13-condor-upgrade-checks_23.9.6-1.1_all.deb ...
Unpacking condor-upgrade-checks (23.9.6-1.1) ...
Selecting previously unselected package libboost-python1.74.0.
Preparing to unpack .../14-libboost-python1.74.0_1.74.0-14ubuntu3_amd64.deb ...
Unpacking libboost-python1.74.0 (1.74.0-14ubuntu3) ...
Selecting previously unselected package condor.
Preparing to unpack .../15-condor_23.9.6-1.1_amd64.deb ...
Unpacking condor (23.9.6-1.1) ...
Selecting previously unselected package pelican.
Preparing to unpack .../16-pelican_7.9.9-1_amd64.deb ...
Unpacking pelican (7.9.9-1) ...
Selecting previously unselected package pelican-osdf-compat.
Preparing to unpack .../17-pelican-osdf-compat_7.9.9-1_amd64.deb ...
Unpacking pelican-osdf-compat (7.9.9-1) ...
Setting up libscitokens0:amd64 (1.1.1-1.1) ...
Setting up libvomsapi1v5:amd64 (2.1.0~rc2-2) ...
Setting up fonts-glyphicons-halflings (1.009~3.4.1+dfsg-2) ...
Setting up libpcre2-16-0:amd64 (10.39-3ubuntu0.1) ...
Setting up libpcre2-32-0:amd64 (10.39-3ubuntu0.1) ...
Setting up libmunge2 (0.5.14-6) ...
Setting up pelican (7.9.9-1) ...
Setting up python3-certifi (2020.6.20-1) ...
Setting up python3-urllib3 (1.26.5-1~exp1ubuntu0.1) ...
Setting up libpcre2-posix3:amd64 (10.39-3ubuntu0.1) ...
Setting up libboost-python1.74.0 (1.74.0-14ubuntu3) ...
Setting up pelican-osdf-compat (7.9.9-1) ...
Setting up libdate-manip-perl (6.86-1) ...
Setting up pcre2-utils (10.39-3ubuntu0.1) ...
Setting up libjs-bootstrap (3.4.1+dfsg-2) ...
Setting up python3-requests (2.25.1+dfsg-2ubuntu0.1) ...
Setting up condor-upgrade-checks (23.9.6-1.1) ...
Setting up condor (23.9.6-1.1) ...
System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down
Created symlink /etc/systemd/system/multi-user.target.wants/condor.service → /lib/systemd/system/condor.service.
Processing triggers for libc-bin (2.35-0ubuntu3.8) ...
Processing triggers for man-db (2.10.2-1) ...
NEEDRESTART-VER: 3.5
NEEDRESTART-KCUR: 5.4.0-149-generic
NEEDRESTART-KSTA: 0
NEEDRESTART-UCSTA: 0

# Configuring role, if any ...
Account: condor_pool@DataCenterCompute000
CredType: password

Operation succeeded.

# Start the HTCondor service in the background (without systemd)
+ sh -c condor_master

root@DataCenterCompute000:~#
```

It looks like there is a problem with using `systemd` within the Zun containers by default.
```
System has not been booted with systemd as init system (PID 1). Can't operate.
```
Checking with the ARA team to see if this is a configuration choice in their deployment or simply a limitation of Zun. For the time being, we will processed with the manual backgrounding of the HTCondor processes/daemons as instructed. In any case, the HTCondor daemons for the central manager still appear to have started up automatically upon installation.

```
top - 18:55:46 up 444 days, 23:05,  0 users,  load average: 0.21, 0.31, 0.29
Tasks:  10 total,   1 running,   9 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem : 386420.9 total, 336092.3 free,   8853.6 used,  41474.9 buff/cache
MiB Swap:   8192.0 total,   8182.4 free,      9.6 used. 374970.5 avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
      1 root      20   0    4620   3632   3196 S   0.0   0.0   0:00.02 bash
  10132 root      20   0   15424   5432   3804 S   0.0   0.0   0:00.00 sshd
  10149 root      20   0   17168  11292   8920 S   0.0   0.0   0:00.15 sshd
  10204 root      20   0    6200   5404   3620 S   0.0   0.0   0:00.02 bash
  11423 condor    20   0   22208  13060  10884 S   0.0   0.0   0:00.01 condor_master
  11457 root      20   0    8612   4296   3972 S   0.0   0.0   0:00.00 condor_procd
  11458 condor    20   0   18448  14040  12480 S   0.0   0.0   0:00.01 condor_shared_p
  11459 condor    20   0   19308  15776  13624 S   0.0   0.0   0:00.04 condor_collecto
  11460 condor    20   0   19036  15048  13128 S   0.0   0.0   0:00.04 condor_negotiat
  11522 root      20   0    7796   3416   3048 R   0.0   0.0   0:00.00 top
```

Maybe I spoke too soon. When the container was killed due to my lease expiring, the next deoployment of the central manager encountered the following issue on startup.

```
root@DataCenterCompute000:~# cat /var/log/condor/MasterLog 
08/14/24 19:17:45 ******************************************************
08/14/24 19:17:45 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 19:17:45 ** /usr/sbin/condor_master
08/14/24 19:17:45 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 19:17:45 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 19:17:45 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 19:17:45 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 19:17:45 ** PID = 13024 RealUID = 0
08/14/24 19:17:45 ** Log last touched time unavailable (No such file or directory)
08/14/24 19:17:45 ******************************************************
08/14/24 19:17:45 Using config source: /etc/condor/condor_config
08/14/24 19:17:45 Using local config sources: 
08/14/24 19:17:45    /etc/condor/config.d/01-central-manager.config
08/14/24 19:17:45    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 19:17:45    /etc/condor/condor_config.local
08/14/24 19:17:45 config Macros = 70, Sorted = 70, StringBytes = 1933, TablesBytes = 2576
08/14/24 19:17:45 CLASSAD_CACHING is OFF
08/14/24 19:17:45 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 19:17:46 SharedPortEndpoint: waiting for connections to named socket master_13024_45f4
08/14/24 19:17:46 SharedPortEndpoint: failed to open /var/lock/condor/shared_port_ad: No such file or directory
08/14/24 19:17:46 SharedPortEndpoint: did not successfully find SharedPortServer address. Will retry in 60s.
08/14/24 19:17:46 DaemonCore: private command socket at <10.0.4.242:0?alias=DataCenterCompute000&sock=master_13024_45f4>
08/14/24 19:17:46 Adding SHARED_PORT to DAEMON_LIST, because USE_SHARED_PORT=true (to disable this, set AUTO_INCLUDE_SHARED_PORT_IN_DAEMON_LIST=False)
08/14/24 19:17:46 SHARED_PORT is in front of a COLLECTOR, so it will use the configured collector port
08/14/24 19:17:46 Master restart (GRACEFUL) is watching /usr/sbin/condor_master (mtime:1723078240)
08/14/24 19:17:47 Started DaemonCore process "/usr/libexec/condor/condor_shared_port", pid and pgroup = 13059
08/14/24 19:17:47 Waiting for /var/lock/condor/shared_port_ad to appear.
08/14/24 19:17:47 Found /var/lock/condor/shared_port_ad.
08/14/24 19:17:47 Started DaemonCore process "/usr/sbin/condor_collector", pid and pgroup = 13060
08/14/24 19:17:47 Waiting for /var/log/condor/.collector_address to appear.
08/14/24 19:17:47 Found /var/log/condor/.collector_address.
08/14/24 19:17:47 Started DaemonCore process "/usr/sbin/condor_negotiator", pid and pgroup = 13061
08/14/24 19:17:47 Daemons::StartAllDaemons all daemons were started
08/14/24 19:18:10 ******************************************************
08/14/24 19:18:10 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 19:18:10 ** /usr/sbin/condor_master
08/14/24 19:18:10 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 19:18:10 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 19:18:10 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 19:18:10 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 19:18:10 ** PID = 13068 RealUID = 0
08/14/24 19:18:10 ** Log last touched 8/14 19:17:47
08/14/24 19:18:10 ******************************************************
08/14/24 19:18:10 Using config source: /etc/condor/condor_config
08/14/24 19:18:10 Using local config sources: 
08/14/24 19:18:10    /etc/condor/config.d/01-central-manager.config
08/14/24 19:18:10    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 19:18:10    /etc/condor/condor_config.local
08/14/24 19:18:10 config Macros = 70, Sorted = 70, StringBytes = 1933, TablesBytes = 2576
08/14/24 19:18:10 CLASSAD_CACHING is OFF
08/14/24 19:18:10 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 19:18:10 lock_file returning ERROR, errno=11 (Resource temporarily unavailable)
08/14/24 19:18:10 FileLock::obtain(1) failed - errno 11 (Resource temporarily unavailable)
08/14/24 19:18:10 ERROR "Can't get lock on "/var/lock/condor/InstanceLock"" at line 1621 in file ./src/condor_master.V6/master.cpp
08/14/24 19:19:02 Handling admin command RESTART.
08/14/24 19:19:02 Sent SIGTERM to COLLECTOR (pid 13060)
08/14/24 19:19:02 Sent SIGTERM to NEGOTIATOR (pid 13061)
08/14/24 19:19:02 The NEGOTIATOR (pid 13061) exited with status 0
08/14/24 19:19:02 The COLLECTOR (pid 13060) exited with status 0
08/14/24 19:19:02 Sent SIGTERM to SHARED_PORT (pid 13059)
08/14/24 19:19:02 The SHARED_PORT (pid 13059) exited with status 0
08/14/24 19:19:02 About to tell the ProcD to exit
08/14/24 19:19:02 procd (pid = 13058) exited with status 0
08/14/24 19:19:02 All daemons are gone.  Restarting.
08/14/24 19:19:02 Restarting master right away.
08/14/24 19:19:02 Doing exec( "/usr/sbin/condor_master" )
08/14/24 19:19:02 ******************************************************
08/14/24 19:19:02 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 19:19:02 ** /usr/sbin/condor_master
08/14/24 19:19:02 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 19:19:02 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 19:19:02 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 19:19:02 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 19:19:02 ** PID = 13024 RealUID = 0
08/14/24 19:19:02 ** Log last touched 8/14 19:19:02
08/14/24 19:19:02 ******************************************************
08/14/24 19:19:02 Using config source: /etc/condor/condor_config
08/14/24 19:19:02 Using local config sources: 
08/14/24 19:19:02    /etc/condor/config.d/01-central-manager.config
08/14/24 19:19:02    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 19:19:02    /etc/condor/condor_config.local
08/14/24 19:19:02 config Macros = 70, Sorted = 70, StringBytes = 1929, TablesBytes = 2576
08/14/24 19:19:02 CLASSAD_CACHING is OFF
08/14/24 19:19:02 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 19:19:03 SharedPortEndpoint: waiting for connections to named socket master_13024_f58d
08/14/24 19:19:03 SharedPortEndpoint: failed to open /var/lock/condor/shared_port_ad: No such file or directory
08/14/24 19:19:03 SharedPortEndpoint: did not successfully find SharedPortServer address. Will retry in 60s.
08/14/24 19:19:03 DaemonCore: private command socket at <10.0.4.242:0?alias=DataCenterCompute000&sock=master_13024_f58d>
08/14/24 19:19:03 Adding SHARED_PORT to DAEMON_LIST, because USE_SHARED_PORT=true (to disable this, set AUTO_INCLUDE_SHARED_PORT_IN_DAEMON_LIST=False)
08/14/24 19:19:03 SHARED_PORT is in front of a COLLECTOR, so it will use the configured collector port
08/14/24 19:19:03 Master restart (GRACEFUL) is watching /usr/sbin/condor_master (mtime:1723078240)
08/14/24 19:19:03 Started DaemonCore process "/usr/libexec/condor/condor_shared_port", pid and pgroup = 13133
08/14/24 19:19:03 Waiting for /var/lock/condor/shared_port_ad to appear.
08/14/24 19:19:03 Found /var/lock/condor/shared_port_ad.
08/14/24 19:19:03 Started DaemonCore process "/usr/sbin/condor_collector", pid and pgroup = 13134
08/14/24 19:19:03 Waiting for /var/log/condor/.collector_address to appear.
08/14/24 19:19:03 Found /var/log/condor/.collector_address.
08/14/24 19:19:03 Started DaemonCore process "/usr/sbin/condor_negotiator", pid and pgroup = 13135
08/14/24 19:19:03 Daemons::StartAllDaemons all daemons were started
08/14/24 19:19:13 procd (pid = 13132) exited unexpectedly with status 15
08/14/24 19:19:13 attempting to restart the Procd
08/14/24 19:19:24 ******************************************************
08/14/24 19:19:24 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 19:19:24 ** /usr/sbin/condor_master
08/14/24 19:19:24 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 19:19:24 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 19:19:24 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 19:19:24 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 19:19:24 ** PID = 13143 RealUID = 0
08/14/24 19:19:24 ** Log last touched 8/14 19:19:13
08/14/24 19:19:24 ******************************************************
08/14/24 19:19:24 Using config source: /etc/condor/condor_config
08/14/24 19:19:24 Using local config sources: 
08/14/24 19:19:24    /etc/condor/config.d/01-central-manager.config
08/14/24 19:19:24    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 19:19:24    /etc/condor/condor_config.local
08/14/24 19:19:24 config Macros = 70, Sorted = 70, StringBytes = 1933, TablesBytes = 2576
08/14/24 19:19:24 CLASSAD_CACHING is OFF
08/14/24 19:19:24 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 19:19:24 lock_file returning ERROR, errno=11 (Resource temporarily unavailable)
08/14/24 19:19:24 FileLock::obtain(1) failed - errno 11 (Resource temporarily unavailable)
08/14/24 19:19:24 ERROR "Can't get lock on "/var/lock/condor/InstanceLock"" at line 1621 in file ./src/condor_master.V6/master.cpp
root@DataCenterCompute000:~#
```

Found these references about the possible issue:
- https://lists.cs.wisc.edu/archive/htcondor-users/2005-August/msg00196.shtml
- https://lists.cs.wisc.edu/archive/htcondor-users/2010-November/msg00046.shtml
- https://bugzilla.redhat.com/show_bug.cgi?id=502171

We may be able to resolve this issue by setting a different value of `MASTER_INSTANCE_LOCK`:
- https://htcondor.readthedocs.io/en/latest/admin-manual/configuration-macros.html#MASTER_INSTANCE_LOCK

After simply redeploying a few times, the issue resolved itself. So, lets go ahead and move on to the submit node deployment ...

*Command*:
```
curl -fsSL https://get.htcondor.org | sudo GET_HTCONDOR_PASSWORD="XXXXXXXXXXXXXXXXXXXX" /bin/bash -s -- --no-dry-run --submit 10.0.4.242
```

It looks like the deployment succeeded.
```
top - 20:02:10 up 176 days, 15:35,  0 users,  load average: 0.16, 0.35, 0.30
Tasks:   9 total,   1 running,   8 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem : 386400.4 total, 355510.4 free,   9032.3 used,  21857.7 buff/cache
MiB Swap:   8192.0 total,   8186.2 free,      5.8 used. 374771.6 avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
      1 root      20   0    4620   3596   3184 S   0.0   0.0   0:00.02 bash
  11735 root      20   0   15424   5320   3760 S   0.0   0.0   0:00.00 sshd
  11752 root      20   0   17168  11164   8884 S   0.0   0.0   0:00.05 sshd
  11807 root      20   0    6068   5156   3492 S   0.0   0.0   0:00.02 bash
  13041 condor    20   0   22320  13200  10968 S   0.0   0.0   0:00.01 condor_master
  13079 root      20   0    8612   3624   3404 S   0.0   0.0   0:00.00 condor_procd
  13080 condor    20   0   18452  13864  12300 S   0.0   0.0   0:00.00 condor_shared_p
  13081 condor    20   0   20452  16488  14140 S   0.0   0.0   0:00.01 condor_schedd
  13084 root      20   0    7800   3196   2828 R   0.0   0.0   0:00.00 top
```

```
root@DataCenterCompute001:~# cat /var/log/condor/
.master_address      MasterLog            SchedLog             SharedPortLog        
KernelTuning.log     ProcLog              ScheddRestartReport  
root@DataCenterCompute001:~# cat /var/log/condor/SchedLog 
08/14/24 20:00:00 (pid:13081) Setting maximum file descriptors to 20000.
08/14/24 20:00:00 (pid:13081) ******************************************************
08/14/24 20:00:00 (pid:13081) ** condor_schedd (CONDOR_SCHEDD) STARTING UP
08/14/24 20:00:00 (pid:13081) ** /usr/sbin/condor_schedd
08/14/24 20:00:00 (pid:13081) ** SubsystemInfo: name=SCHEDD type=SCHEDD(4) class=DAEMON(1)
08/14/24 20:00:00 (pid:13081) ** Configuration: subsystem:SCHEDD local:<NONE> class:DAEMON
08/14/24 20:00:00 (pid:13081) ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 20:00:00 (pid:13081) ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 20:00:00 (pid:13081) ** PID = 13081 RealUID = 0
08/14/24 20:00:00 (pid:13081) ** Log last touched time unavailable (No such file or directory)
08/14/24 20:00:00 (pid:13081) ******************************************************
08/14/24 20:00:00 (pid:13081) Using config source: /etc/condor/condor_config
08/14/24 20:00:00 (pid:13081) Using local config sources: 
08/14/24 20:00:00 (pid:13081)    /etc/condor/config.d/01-submit.config
08/14/24 20:00:00 (pid:13081)    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 20:00:00 (pid:13081)    /etc/condor/condor_config.local
08/14/24 20:00:00 (pid:13081) config Macros = 71, Sorted = 71, StringBytes = 1977, TablesBytes = 2612
08/14/24 20:00:00 (pid:13081) CLASSAD_CACHING is ENABLED
08/14/24 20:00:00 (pid:13081) Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 20:00:00 (pid:13081) SharedPortEndpoint: waiting for connections to named socket schedd_13041_ef11
08/14/24 20:00:00 (pid:13081) DaemonCore: command socket at <10.0.4.243:9618?addrs=10.0.4.243-9618&alias=DataCenterCompute001&noUDP&sock=schedd_13041_ef11>
08/14/24 20:00:00 (pid:13081) DaemonCore: private command socket at <10.0.4.243:9618?addrs=10.0.4.243-9618&alias=DataCenterCompute001&noUDP&sock=schedd_13041_ef11>
08/14/24 20:00:00 (pid:13081) History file rotation is enabled.
08/14/24 20:00:00 (pid:13081)   Maximum history file size is: 20971520 bytes
08/14/24 20:00:00 (pid:13081)   Number of rotated history files is: 2
08/14/24 20:00:00 (pid:13081) config super users : root, condor
08/14/24 20:00:00 (pid:13081) Reloading job factories
08/14/24 20:00:00 (pid:13081) Loaded 0 job factories, 0 were paused, 0 failed to load
08/14/24 20:00:00 (pid:13081) TransferQueueManager stats: active up=0/100 down=0/100; waiting up=0 down=0; wait time up=0s down=0s
08/14/24 20:00:00 (pid:13081) TransferQueueManager upload 1m I/O load: 0 bytes/s  0.000 disk load  0.000 net load
08/14/24 20:00:00 (pid:13081) TransferQueueManager download 1m I/O load: 0 bytes/s  0.000 disk load  0.000 net load
08/14/24 20:00:00 (pid:13081) my_popenv: Failed to exec /usr/bin/mail, errno=2 (No such file or directory)
08/14/24 20:00:00 (pid:13081) Failed to launch mailer process: /usr/bin/mail
```

```
root@DataCenterCompute001:~# cat /var/log/condor/MasterLog 
08/14/24 19:59:59 ******************************************************
08/14/24 19:59:59 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 19:59:59 ** /usr/sbin/condor_master
08/14/24 19:59:59 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 19:59:59 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 19:59:59 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 19:59:59 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 19:59:59 ** PID = 13041 RealUID = 0
08/14/24 19:59:59 ** Log last touched time unavailable (No such file or directory)
08/14/24 19:59:59 ******************************************************
08/14/24 19:59:59 Using config source: /etc/condor/condor_config
08/14/24 19:59:59 Using local config sources: 
08/14/24 19:59:59    /etc/condor/config.d/01-submit.config
08/14/24 19:59:59    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 19:59:59    /etc/condor/condor_config.local
08/14/24 19:59:59 config Macros = 70, Sorted = 70, StringBytes = 1935, TablesBytes = 2576
08/14/24 19:59:59 CLASSAD_CACHING is OFF
08/14/24 19:59:59 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 20:00:00 SharedPortEndpoint: waiting for connections to named socket master_13041_ef11
08/14/24 20:00:00 SharedPortEndpoint: failed to open /var/lock/condor/shared_port_ad: No such file or directory
08/14/24 20:00:00 SharedPortEndpoint: did not successfully find SharedPortServer address. Will retry in 60s.
08/14/24 20:00:00 DaemonCore: private command socket at <10.0.4.243:0?alias=DataCenterCompute001&sock=master_13041_ef11>
08/14/24 20:00:00 Adding SHARED_PORT to DAEMON_LIST, because USE_SHARED_PORT=true (to disable this, set AUTO_INCLUDE_SHARED_PORT_IN_DAEMON_LIST=False)
08/14/24 20:00:00 Master restart (GRACEFUL) is watching /usr/sbin/condor_master (mtime:1723078240)
08/14/24 20:00:00 Starting shared port with port: 9618
08/14/24 20:00:00 Started DaemonCore process "/usr/libexec/condor/condor_shared_port", pid and pgroup = 13080
08/14/24 20:00:00 Waiting for /var/lock/condor/shared_port_ad to appear.
08/14/24 20:00:00 Found /var/lock/condor/shared_port_ad.
08/14/24 20:00:00 Started DaemonCore process "/usr/sbin/condor_schedd", pid and pgroup = 13081
08/14/24 20:00:00 Daemons::StartAllDaemons all daemons were started
root@DataCenterCompute001:~#
```

```
root@DataCenterCompute001:~# condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:1439?... @ 08/14/24 20:05:03
OWNER BATCH_NAME      SUBMITTED   DONE   RUN    IDLE   HOLD  TOTAL JOB_IDS

Total for query: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for condor: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for all users: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended

root@DataCenterCompute001:~#
```

```
root@DataCenterCompute001:~# condor_status
root@DataCenterCompute001:~# echo $?
0
root@DataCenterCompute001:~#
```

And the collector sees the schedd ... 

```
08/14/24 20:05:01 ScheddAd     : Updating ... "< DataCenterCompute001 >"
08/14/24 20:05:05 MasterAd     : Updating ... "< DataCenterCompute001 >"
08/14/24 20:05:18 Got QUERY_STARTD_ADS
08/14/24 20:05:18 QueryWorker: forked new worker with id 13092 ( max 4 active 1 pending 0 )
08/14/24 20:05:18 Query info: matched=0; skipped=0; query_time=0.000998; send_time=0.000157; type=Machine; requirements={true}; locate=0; limit=0; from=TOOL; peer=<10.0.4.243:8823>; projection={Activity Arch CondorLoadAvg EnteredCurrentActivity LastHeardFrom Machine Memory MyCurrentTime Name OpSys State}; filter_private_attrs=1
08/14/24 20:05:40 Got QUERY_STARTD_PVT_ADS
08/14/24 20:05:40 QueryWorker: forked new high priority worker with id 13111 ( max 4 active 1 pending 0 )
08/14/24 20:05:40 Query info: matched=0; skipped=0; query_time=0.000334; send_time=0.000130; type=MachinePrivate; requirements={true}; locate=0; limit=0; from=COLLECTOR; peer=<10.0.4.242:45757>; projection={}; filter_private_attrs=1
08/14/24 20:05:40 Got QUERY_MULTIPLE_PVT_ADS
08/14/24 20:05:40 QueryWorker: forked new high priority worker with id 13112 ( max 4 active 1 pending 0 )
08/14/24 20:05:40 Query info: matched=0; skipped=0; query_time=0.000305; send_time=0.000107; type=Multi; requirements={}; locate=0; limit=0; from=COLLECTOR; peer=<10.0.4.242:39551>; projection={}; filter_private_attrs=0
08/14/24 20:05:40 AccountingAd  : Updating ... "< <none>DataCenterCompute000 >"
root@DataCenterCompute000:~# 
```

Negoritator is cycling ...

```
08/14/24 20:18:40 ---------- Started Negotiation Cycle ----------
08/14/24 20:18:40 Phase 1:  Obtaining ads from collector ...
08/14/24 20:18:40   Getting startd private ads ...
08/14/24 20:18:40   Getting Scheduler, Submitter and Machine ads ...
08/14/24 20:18:40   Sorting 0 ads ...
08/14/24 20:18:40 Got ads: 0 public and 0 private
08/14/24 20:18:40 Public ads include 0 submitter, 0 startd
08/14/24 20:18:40 Phase 2:  Performing accounting ...
08/14/24 20:18:40 Phase 3:  Sorting submitter ads by priority ...
08/14/24 20:18:40 Starting prefetch round; 0 potential prefetches to do.
08/14/24 20:18:40 Prefetch summary: 0 attempted, 0 successful.
08/14/24 20:18:40 Phase 4.1:  Negotiating with schedds ...
08/14/24 20:18:40  negotiateWithGroup resources used submitterAds length 0 
08/14/24 20:18:40 ---------- Finished Negotiation Cycle ----------
```

Moving forward with first worker deployment on `AgronomyFarm-Edge-000`. Note, however, in the future, we should try to avoid the CUDA upgrade that occurs when running `apt-get -y upgrade`.

*Command*:

```
curl -fsSL https://get.htcondor.org | GET_HTCONDOR_PASSWORD="XXXXXXXXXXXXXXXXX" /bin/bash -s -- --no-dry-run --execute 10.0.4.242
```

*Output*:

```
root@AgronomyFarmEdge000:~# curl -fsSL https://get.htcondor.org | GET_HTCONDOR_PASSWORD="XXXXXXXXXXXXXXXXXXXXXXXXX" /bin/bash -s -- --no-dry-run --execute 10.0.4.242

# Installing HTCondor as execute for Ubuntu focal
+ echo -e '\n# Adding our repository'

# Adding our repository
+ apt_get='DEBIAN_FRONTEND=noninteractive apt-get'
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get update'
Get:1 http://archive.ubuntu.com/ubuntu focal InRelease [265 kB]
Get:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64  InRelease [1581 B]
Get:3 http://security.ubuntu.com/ubuntu focal-security InRelease [128 kB]                
Err:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64  InRelease
  The following signatures couldn't be verified because the public key is not available: NO_PUBKEY A4B469963BF863CC
Ign:4 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  InRelease
Get:5 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  Release [564 B]
Get:6 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  Release.gpg [833 B]
Get:7 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  Packages [2445 B]
Get:8 http://archive.ubuntu.com/ubuntu focal-updates InRelease [128 kB]
Get:9 http://archive.ubuntu.com/ubuntu focal-backports InRelease [128 kB]
Get:10 http://security.ubuntu.com/ubuntu focal-security/main amd64 Packages [3885 kB]
Get:11 http://archive.ubuntu.com/ubuntu focal/main amd64 Packages [1275 kB]
Get:12 http://archive.ubuntu.com/ubuntu focal/main amd64 c-n-f Metadata [29.5 kB]
Get:13 http://archive.ubuntu.com/ubuntu focal/restricted amd64 Packages [33.4 kB]       
Get:14 http://archive.ubuntu.com/ubuntu focal/restricted amd64 c-n-f Metadata [392 B]
Get:15 http://archive.ubuntu.com/ubuntu focal/universe amd64 Packages [11.3 MB]       
Get:16 http://security.ubuntu.com/ubuntu focal-security/main amd64 c-n-f Metadata [14.1 kB]
Get:17 http://security.ubuntu.com/ubuntu focal-security/restricted amd64 Packages [3867 kB]         
Get:18 http://security.ubuntu.com/ubuntu focal-security/restricted amd64 c-n-f Metadata [544 B]
Get:19 http://security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [1257 kB]     
Get:20 http://security.ubuntu.com/ubuntu focal-security/universe amd64 c-n-f Metadata [21.1 kB]
Get:21 http://security.ubuntu.com/ubuntu focal-security/multiverse amd64 Packages [30.9 kB]          
Get:22 http://security.ubuntu.com/ubuntu focal-security/multiverse amd64 c-n-f Metadata [540 B]
Get:23 http://archive.ubuntu.com/ubuntu focal/universe amd64 c-n-f Metadata [265 kB]              
Get:24 http://archive.ubuntu.com/ubuntu focal/multiverse amd64 Packages [177 kB]
Get:25 http://archive.ubuntu.com/ubuntu focal/multiverse amd64 c-n-f Metadata [9136 B]
Get:26 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [4351 kB]
Get:27 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 c-n-f Metadata [17.7 kB]
Get:28 http://archive.ubuntu.com/ubuntu focal-updates/restricted amd64 Packages [4018 kB]
Get:29 http://archive.ubuntu.com/ubuntu focal-updates/restricted amd64 c-n-f Metadata [540 B]
Get:30 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [1543 kB]
Get:31 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 c-n-f Metadata [27.8 kB]
Get:32 http://archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 Packages [33.5 kB]
Get:33 http://archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 c-n-f Metadata [616 B]
Get:34 http://archive.ubuntu.com/ubuntu focal-backports/main amd64 Packages [55.2 kB]
Get:35 http://archive.ubuntu.com/ubuntu focal-backports/main amd64 c-n-f Metadata [1420 B]
Get:36 http://archive.ubuntu.com/ubuntu focal-backports/restricted amd64 c-n-f Metadata [116 B]
Get:37 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 Packages [28.6 kB]
Get:38 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 c-n-f Metadata [880 B]
Get:39 http://archive.ubuntu.com/ubuntu focal-backports/multiverse amd64 c-n-f Metadata [116 B]
Reading package lists... Done                                   
W: GPG error: https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64  InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY A4B469963BF863CC
E: The repository 'https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64  InRelease' is not signed.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
root@AgronomyFarmEdge000:~#

```

Changing to the base Ubuntu 22.04 container instead of the CUDA-enabled one specifically for the AgronomyFarm-Edge-000 ...

*Output*:
```
root@AgronomyFarmEdge000:~# curl -fsSL https://get.htcondor.org | GET_HTCONDOR_PASSWORD="XXXXXXXXXXXXXXXXX" /bin/bash -s -- --no-dry-run --execute 10.0.4.242

# Installing HTCondor as execute for Ubuntu jammy
+ echo -e '\n# Adding our repository'

# Adding our repository
+ apt_get='DEBIAN_FRONTEND=noninteractive apt-get'
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get update'
Get:1 http://archive.ubuntu.com/ubuntu jammy InRelease [270 kB]
Get:2 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy InRelease [5901 B]
Get:3 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]           
Get:4 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy/main amd64 Packages [71.1 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]                        
Get:6 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]                
Get:7 http://archive.ubuntu.com/ubuntu jammy/main amd64 Packages [1792 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy/main amd64 c-n-f Metadata [30.3 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy/restricted amd64 Packages [164 kB]                 
Get:10 http://archive.ubuntu.com/ubuntu jammy/restricted amd64 c-n-f Metadata [488 B]   
Get:11 http://archive.ubuntu.com/ubuntu jammy/universe amd64 Packages [17.5 MB]
Get:12 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [2169 kB]     
Get:13 http://archive.ubuntu.com/ubuntu jammy/universe amd64 c-n-f Metadata [286 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy/multiverse amd64 Packages [266 kB]                
Get:15 http://archive.ubuntu.com/ubuntu jammy/multiverse amd64 c-n-f Metadata [8372 B]      
Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [2446 kB]               
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 c-n-f Metadata [17.8 kB]   
Get:18 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [2963 kB]         
Get:19 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 c-n-f Metadata [604 B]
Get:20 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1422 kB]          
Get:21 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 c-n-f Metadata [25.9 kB]
Get:22 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 Packages [51.8 kB]            
Get:23 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 c-n-f Metadata [444 B] 
Get:24 http://archive.ubuntu.com/ubuntu jammy-backports/main amd64 Packages [81.0 kB]            
Get:25 http://archive.ubuntu.com/ubuntu jammy-backports/main amd64 c-n-f Metadata [388 B]     
Get:26 http://archive.ubuntu.com/ubuntu jammy-backports/restricted amd64 c-n-f Metadata [116 B]  
Get:27 http://archive.ubuntu.com/ubuntu jammy-backports/universe amd64 Packages [33.7 kB]        
Get:28 http://archive.ubuntu.com/ubuntu jammy-backports/universe amd64 c-n-f Metadata [672 B] 
Get:29 http://archive.ubuntu.com/ubuntu jammy-backports/multiverse amd64 c-n-f Metadata [116 B]  
Get:30 http://security.ubuntu.com/ubuntu jammy-security/main amd64 c-n-f Metadata [13.1 kB]
Get:31 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [2867 kB]
Get:32 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 c-n-f Metadata [572 B]
Get:33 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [1133 kB]
Get:34 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 c-n-f Metadata [19.0 kB]
Get:35 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 Packages [44.7 kB]
Get:36 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 c-n-f Metadata [228 B]
Fetched 34.0 MB in 2s (18.6 MB/s)                               
Reading package lists... Done
W: https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y gnupg'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
gnupg is already the newest version (2.2.27-3ubuntu2.1).
gnupg set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ sh -c 'mkdir -p /etc/apt/keyrings'
+ sh -c 'curl -fsSL https://research.cs.wisc.edu/htcondor/repo/keys/HTCondor-current-Key -o /etc/apt/keyrings/HTCondor-current-Key'
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install apt-transport-https'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  apt-transport-https
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 1510 B of archives.
After this operation, 170 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 apt-transport-https all 2.4.12 [1510 B]
Fetched 1510 B in 0s (7403 B/s)               
Selecting previously unselected package apt-transport-https.
(Reading database ... 48156 files and directories currently installed.)
Preparing to unpack .../apt-transport-https_2.4.12_all.deb ...
Unpacking apt-transport-https (2.4.12) ...
Setting up apt-transport-https (2.4.12) ...
NEEDRESTART-VER: 3.5
NEEDRESTART-KCUR: 5.4.0-190-generic
NEEDRESTART-KSTA: 0
NEEDRESTART-UCSTA: 0
+ HTCONDOR_LIST=/etc/apt/sources.list.d/htcondor.list
+ sh -c 'echo "deb [signed-by=/etc/apt/keyrings/HTCondor-current-Key] https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy main" > /etc/apt/sources.list.d/htcondor.list'
+ sh -c 'echo "deb-src [signed-by=/etc/apt/keyrings/HTCondor-current-Key] https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy main" >> /etc/apt/sources.list.d/htcondor.list'
+ echo -e '\n# Updating package lists'

# Updating package lists
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get update'
Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy InRelease
Get:3 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy InRelease [5901 B]
Hit:4 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Get:6 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main Sources [7019 B]
Get:7 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 Packages [82.1 kB]
Hit:8 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Fetched 95.0 kB in 0s (205 kB/s)                    
Reading package lists... Done
W: https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
+ echo -e '\n# Installing ps'

# Installing ps
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y procps'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
procps is already the newest version (2:3.3.17-6ubuntu2.1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ case $lsb_dist.$dist_version in
+ echo -e '\n# Preconfiguring packages for Ubuntu.'

# Preconfiguring packages for Ubuntu.
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y keyboard-configuration console-setup tzdata'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
console-setup is already the newest version (1.205ubuntu3).
console-setup set to manually installed.
keyboard-configuration is already the newest version (1.205ubuntu3).
keyboard-configuration set to manually installed.
tzdata is already the newest version (2024a-0ubuntu0.22.04.1).
tzdata set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
+ echo -e '\n# Installing HTCondor binaries and dependencies'

# Installing HTCondor binaries and dependencies
+ [[ ! -n execute ]]
+ sh -c 'DEBIAN_FRONTEND=noninteractive apt-get install -y condor'
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  condor-upgrade-checks fonts-glyphicons-halflings libboost-python1.74.0 libdate-manip-perl libjs-bootstrap
  libmunge2 libpcre2-16-0 libpcre2-32-0 libpcre2-posix3 libscitokens0 libvomsapi1v5 pcre2-utils pelican
  pelican-osdf-compat python3-certifi python3-requests python3-urllib3
Suggested packages:
  docker.io coop-computing-tools singularity-container slurm-client python3-socks python-requests-doc
The following NEW packages will be installed:
  condor condor-upgrade-checks fonts-glyphicons-halflings libboost-python1.74.0 libdate-manip-perl libjs-bootstrap
  libmunge2 libpcre2-16-0 libpcre2-32-0 libpcre2-posix3 libscitokens0 libvomsapi1v5 pcre2-utils pelican
  pelican-osdf-compat python3-certifi python3-requests python3-urllib3
0 upgraded, 18 newly installed, 0 to remove and 0 not upgraded.
Need to get 27.0 MB of archives.
After this operation, 94.5 MB of additional disk space will be used.
Get:1 https://research.cs.wisc.edu/htcondor/repo/ubuntu/23.0 jammy/main amd64 libscitokens0 amd64 1.1.1-1.1 [123 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy/main amd64 libdate-manip-perl all 6.86-1 [946 kB]
Get:3 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 condor-upgrade-checks all 23.9.6-1.1 [42.3 kB]
Get:4 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 condor amd64 23.9.6-1.1 [8524 kB]
Get:5 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 pelican amd64 7.9.9-1 [15.9 MB]
Get:6 https://research.cs.wisc.edu/htcondor/repo/ubuntu/current jammy/main amd64 pelican-osdf-compat amd64 7.9.9-1 [1502 B]
Get:7 http://archive.ubuntu.com/ubuntu jammy/main amd64 python3-certifi all 2020.6.20-1 [150 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-urllib3 all 1.26.5-1~exp1ubuntu0.1 [98.2 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-requests all 2.25.1+dfsg-2ubuntu0.1 [48.8 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libmunge2 amd64 0.5.14-6 [15.7 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy/universe amd64 fonts-glyphicons-halflings all 1.009~3.4.1+dfsg-2 [117 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libjs-bootstrap all 3.4.1+dfsg-2 [124 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy/universe amd64 libvomsapi1v5 amd64 2.1.0~rc2-2 [140 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-16-0 amd64 10.39-3ubuntu0.1 [203 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-32-0 amd64 10.39-3ubuntu0.1 [194 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpcre2-posix3 amd64 10.39-3ubuntu0.1 [6130 B]
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 pcre2-utils amd64 10.39-3ubuntu0.1 [128 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy/main amd64 libboost-python1.74.0 amd64 1.74.0-14ubuntu3 [299 kB]
Fetched 27.0 MB in 1s (23.2 MB/s)              
Selecting previously unselected package libdate-manip-perl.
(Reading database ... 48160 files and directories currently installed.)
Preparing to unpack .../00-libdate-manip-perl_6.86-1_all.deb ...
Unpacking libdate-manip-perl (6.86-1) ...
Selecting previously unselected package python3-certifi.
Preparing to unpack .../01-python3-certifi_2020.6.20-1_all.deb ...
Unpacking python3-certifi (2020.6.20-1) ...
Selecting previously unselected package python3-urllib3.
Preparing to unpack .../02-python3-urllib3_1.26.5-1~exp1ubuntu0.1_all.deb ...
Unpacking python3-urllib3 (1.26.5-1~exp1ubuntu0.1) ...
Selecting previously unselected package python3-requests.
Preparing to unpack .../03-python3-requests_2.25.1+dfsg-2ubuntu0.1_all.deb ...
Unpacking python3-requests (2.25.1+dfsg-2ubuntu0.1) ...
Selecting previously unselected package libmunge2.
Preparing to unpack .../04-libmunge2_0.5.14-6_amd64.deb ...
Unpacking libmunge2 (0.5.14-6) ...
Selecting previously unselected package fonts-glyphicons-halflings.
Preparing to unpack .../05-fonts-glyphicons-halflings_1.009~3.4.1+dfsg-2_all.deb ...
Unpacking fonts-glyphicons-halflings (1.009~3.4.1+dfsg-2) ...
Selecting previously unselected package libjs-bootstrap.
Preparing to unpack .../06-libjs-bootstrap_3.4.1+dfsg-2_all.deb ...
Unpacking libjs-bootstrap (3.4.1+dfsg-2) ...
Selecting previously unselected package libscitokens0:amd64.
Preparing to unpack .../07-libscitokens0_1.1.1-1.1_amd64.deb ...
Unpacking libscitokens0:amd64 (1.1.1-1.1) ...
Selecting previously unselected package libvomsapi1v5:amd64.
Preparing to unpack .../08-libvomsapi1v5_2.1.0~rc2-2_amd64.deb ...
Unpacking libvomsapi1v5:amd64 (2.1.0~rc2-2) ...
Selecting previously unselected package libpcre2-16-0:amd64.
Preparing to unpack .../09-libpcre2-16-0_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-16-0:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package libpcre2-32-0:amd64.
Preparing to unpack .../10-libpcre2-32-0_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-32-0:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package libpcre2-posix3:amd64.
Preparing to unpack .../11-libpcre2-posix3_10.39-3ubuntu0.1_amd64.deb ...
Unpacking libpcre2-posix3:amd64 (10.39-3ubuntu0.1) ...
Selecting previously unselected package pcre2-utils.
Preparing to unpack .../12-pcre2-utils_10.39-3ubuntu0.1_amd64.deb ...
Unpacking pcre2-utils (10.39-3ubuntu0.1) ...
Selecting previously unselected package condor-upgrade-checks.
Preparing to unpack .../13-condor-upgrade-checks_23.9.6-1.1_all.deb ...
Unpacking condor-upgrade-checks (23.9.6-1.1) ...
Selecting previously unselected package libboost-python1.74.0.
Preparing to unpack .../14-libboost-python1.74.0_1.74.0-14ubuntu3_amd64.deb ...
Unpacking libboost-python1.74.0 (1.74.0-14ubuntu3) ...
Selecting previously unselected package condor.
Preparing to unpack .../15-condor_23.9.6-1.1_amd64.deb ...
Unpacking condor (23.9.6-1.1) ...
Selecting previously unselected package pelican.
Preparing to unpack .../16-pelican_7.9.9-1_amd64.deb ...
Unpacking pelican (7.9.9-1) ...
Selecting previously unselected package pelican-osdf-compat.
Preparing to unpack .../17-pelican-osdf-compat_7.9.9-1_amd64.deb ...
Unpacking pelican-osdf-compat (7.9.9-1) ...
Setting up libscitokens0:amd64 (1.1.1-1.1) ...
Setting up libvomsapi1v5:amd64 (2.1.0~rc2-2) ...
Setting up fonts-glyphicons-halflings (1.009~3.4.1+dfsg-2) ...
Setting up libpcre2-16-0:amd64 (10.39-3ubuntu0.1) ...
Setting up libpcre2-32-0:amd64 (10.39-3ubuntu0.1) ...
Setting up libmunge2 (0.5.14-6) ...
Setting up pelican (7.9.9-1) ...
Setting up python3-certifi (2020.6.20-1) ...
Setting up python3-urllib3 (1.26.5-1~exp1ubuntu0.1) ...
Setting up libpcre2-posix3:amd64 (10.39-3ubuntu0.1) ...
Setting up libboost-python1.74.0 (1.74.0-14ubuntu3) ...
Setting up pelican-osdf-compat (7.9.9-1) ...
Setting up libdate-manip-perl (6.86-1) ...
Setting up pcre2-utils (10.39-3ubuntu0.1) ...
Setting up libjs-bootstrap (3.4.1+dfsg-2) ...
Setting up python3-requests (2.25.1+dfsg-2ubuntu0.1) ...
Setting up condor-upgrade-checks (23.9.6-1.1) ...
Setting up condor (23.9.6-1.1) ...
System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down
Created symlink /etc/systemd/system/multi-user.target.wants/condor.service → /lib/systemd/system/condor.service.
Processing triggers for libc-bin (2.35-0ubuntu3.8) ...
Processing triggers for man-db (2.10.2-1) ...
NEEDRESTART-VER: 3.5
NEEDRESTART-KCUR: 5.4.0-190-generic
NEEDRESTART-KSTA: 0
NEEDRESTART-UCSTA: 0

# Configuring role, if any ...
Account: condor_pool@AgronomyFarmEdge000
CredType: password

Operation succeeded.

# Start the HTCondor service in the background (without systemd)
+ sh -c condor_master

root@AgronomyFarmEdge000:~#
```

It looks like it worked ...

```
top - 20:37:35 up 11 days,  2:37,  0 users,  load average: 0.54, 0.55, 0.44
Tasks:   9 total,   1 running,   8 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :  63852.5 total,  49984.5 free,   4397.4 used,   9470.6 buff/cache
MiB Swap:   8192.0 total,   8186.7 free,      5.2 used.  58773.5 avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
      1 root      20   0    4620   3580   3184 S   0.0   0.0   0:00.02 bash
  11709 root      20   0   15424   5508   3880 S   0.0   0.0   0:00.00 sshd
  11726 root      20   0   17172  10864   8484 S   0.0   0.0   0:00.04 sshd
  11781 root      20   0    6068   5132   3464 S   0.0   0.0   0:00.01 bash
  13011 condor    20   0   22324  13124  10896 S   0.0   0.0   0:00.00 condor_master
  13043 root      20   0    8612   3552   3336 S   0.0   0.0   0:00.00 condor_procd
  13044 condor    20   0   18448  13908  12348 S   0.0   0.0   0:00.00 condor_shared_p
  13045 condor    20   0   19820  16172  13884 S   0.0   0.0   0:00.01 condor_startd
  13084 root      20   0    7784   3324   2956 R   0.0   0.0   0:00.00 top
```

```
root@AgronomyFarmEdge000:~# cat /var/log/condor/
.master_address         KernelTuning.log        SharedPortLog           XferStatsLog
.startd_address         MasterLog               StartLog                
.startd_claim_id.slot1  ProcLog                 StarterLog.testing      
root@AgronomyFarmEdge000:~# cat /var/log/condor/MasterLog 
08/14/24 20:35:49 ******************************************************
08/14/24 20:35:49 ** condor_master (CONDOR_MASTER) STARTING UP
08/14/24 20:35:49 ** /usr/sbin/condor_master
08/14/24 20:35:49 ** SubsystemInfo: name=MASTER type=MASTER(1) class=DAEMON(1)
08/14/24 20:35:49 ** Configuration: subsystem:MASTER local:<NONE> class:DAEMON
08/14/24 20:35:49 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 20:35:49 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 20:35:49 ** PID = 13011 RealUID = 0
08/14/24 20:35:49 ** Log last touched time unavailable (No such file or directory)
08/14/24 20:35:49 ******************************************************
08/14/24 20:35:49 Using config source: /etc/condor/condor_config
08/14/24 20:35:49 Using local config sources: 
08/14/24 20:35:49    /etc/condor/config.d/01-execute.config
08/14/24 20:35:49    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 20:35:49    /etc/condor/condor_config.local
08/14/24 20:35:49 config Macros = 70, Sorted = 70, StringBytes = 1906, TablesBytes = 2576
08/14/24 20:35:49 CLASSAD_CACHING is OFF
08/14/24 20:35:49 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 20:35:50 SharedPortEndpoint: waiting for connections to named socket master_13011_5b39
08/14/24 20:35:50 SharedPortEndpoint: failed to open /var/lock/condor/shared_port_ad: No such file or directory
08/14/24 20:35:50 SharedPortEndpoint: did not successfully find SharedPortServer address. Will retry in 60s.
08/14/24 20:35:50 DaemonCore: private command socket at <10.0.4.244:0?alias=AgronomyFarmEdge000&sock=master_13011_5b39>
08/14/24 20:35:50 Adding SHARED_PORT to DAEMON_LIST, because USE_SHARED_PORT=true (to disable this, set AUTO_INCLUDE_SHARED_PORT_IN_DAEMON_LIST=False)
08/14/24 20:35:50 Master restart (GRACEFUL) is watching /usr/sbin/condor_master (mtime:1723078240)
08/14/24 20:35:50 Starting shared port with port: 9618
08/14/24 20:35:50 Started DaemonCore process "/usr/libexec/condor/condor_shared_port", pid and pgroup = 13044
08/14/24 20:35:50 Waiting for /var/lock/condor/shared_port_ad to appear.
08/14/24 20:35:51 Found /var/lock/condor/shared_port_ad.
08/14/24 20:35:51 Started DaemonCore process "/usr/sbin/condor_startd", pid and pgroup = 13045
08/14/24 20:35:51 Daemons::StartAllDaemons all daemons were started
08/14/24 20:35:52 Setting ready state 'Ready' for STARTD
root@AgronomyFarmEdge000:~#
```

```
root@AgronomyFarmEdge000:~# cat /var/log/condor/StartLog 
08/14/24 20:35:51 ******************************************************
08/14/24 20:35:51 ** condor_startd (CONDOR_STARTD) STARTING UP
08/14/24 20:35:51 ** /usr/sbin/condor_startd
08/14/24 20:35:51 ** SubsystemInfo: name=STARTD type=STARTD(6) class=DAEMON(1)
08/14/24 20:35:51 ** Configuration: subsystem:STARTD local:<NONE> class:DAEMON
08/14/24 20:35:51 ** $CondorVersion: 23.9.6 2024-08-08 BuildID: 748275 PackageID: 23.9.6-1.1 GitSHA: dfdd9eaa $
08/14/24 20:35:51 ** $CondorPlatform: X86_64-Ubuntu_22.04 $
08/14/24 20:35:51 ** PID = 13045 RealUID = 0
08/14/24 20:35:51 ** Log last touched time unavailable (No such file or directory)
08/14/24 20:35:51 ******************************************************
08/14/24 20:35:51 Using config source: /etc/condor/condor_config
08/14/24 20:35:51 Using local config sources: 
08/14/24 20:35:51    /etc/condor/config.d/01-execute.config
08/14/24 20:35:51    /etc/condor/config.d/10-stash-plugin.conf
08/14/24 20:35:51    /etc/condor/condor_config.local
08/14/24 20:35:51 config Macros = 71, Sorted = 71, StringBytes = 1949, TablesBytes = 2612
08/14/24 20:35:51 CLASSAD_CACHING is ENABLED
08/14/24 20:35:51 Daemon Log is logging: D_ALWAYS D_ERROR D_STATUS
08/14/24 20:35:51 SharedPortEndpoint: waiting for connections to named socket startd_13011_5b39
08/14/24 20:35:51 DaemonCore: command socket at <10.0.4.244:9618?addrs=10.0.4.244-9618&alias=AgronomyFarmEdge000&noUDP&sock=startd_13011_5b39>
08/14/24 20:35:51 DaemonCore: private command socket at <10.0.4.244:9618?addrs=10.0.4.244-9618&alias=AgronomyFarmEdge000&noUDP&sock=startd_13011_5b39>
08/14/24 20:35:51 ioctl(SIOCETHTOOL/GWOL) failed: Operation not supported (95)
08/14/24 20:35:51 You can safely ignore the above error if you're not using hibernation
08/14/24 20:35:51 VM universe will be tested to check if it is available
08/14/24 20:35:51 ENABLE_STARTD_DAEMON_AD=2 (auto)
08/14/24 20:35:51 History file rotation is enabled.
08/14/24 20:35:51   Maximum history file size is: 20971520 bytes
08/14/24 20:35:51   Number of rotated history files is: 2
08/14/24 20:35:51 Startd will not enforce disk limits via logical volume management.
08/14/24 20:35:51 Local machine resource GPUs = 0
08/14/24 20:35:51 Allocating auto shares for slot type 0: Cpus: auto, Memory: auto, Swap: auto, Disk: auto, GPUs: auto
08/14/24 20:35:51   slot type 0: Cpus: 48.000000, Memory: 63852, Swap: 100.00%, Disk: 100.00%, GPUs: 0
08/14/24 20:35:51 bind slot DevIds tag=GPUs contraint=
08/14/24 20:35:51 slot1: New pSlot allocated
08/14/24 20:35:51 slot1: 	Cpus: 48.000000, Memory: 63852, Swap: 100.00%, Disk: 100.00%, GPUs: 0
08/14/24 20:35:51 CronJob: Initializing job 'mips' (/usr/libexec/condor/condor_mips)
08/14/24 20:35:51 CronJob: Initializing job 'kflops' (/usr/libexec/condor/condor_kflops)
08/14/24 20:35:51 ResAttributes detected we do have unpriv user namespaces (pid was 13080: status was 0)
08/14/24 20:35:51 Utmp files /var/run/utmp and /var/adm/utmp missing, assuming infinite keyboard idle time
08/14/24 20:35:51 slot1: State change: IS_OWNER is false
08/14/24 20:35:51 slot1: Changing state: Owner -> Unclaimed
08/14/24 20:35:51 State change: RunBenchmarks is TRUE
08/14/24 20:35:51 slot1: Changing activity: Idle -> Benchmarking
08/14/24 20:35:51 BenchMgr:StartBenchmarks()
08/14/24 20:35:51 BENCHMARK job mips started. pid=13081
08/14/24 20:35:52 Initial update sent to collector(s)
08/14/24 20:35:52 Sending DC_SET_READY message to master <10.0.4.244:9618?addrs=10.0.4.244-9618&alias=AgronomyFarmEdge000&noUDP&sock=master_13011_5b39>
08/14/24 20:36:02 BENCHMARK job kflops started. pid=13082
08/14/24 20:36:23 State change: benchmarks completed
08/14/24 20:36:23 slot1: Changing activity: Benchmarking -> Idle
root@AgronomyFarmEdge000:~#
```

It's working!

```
root@DataCenterCompute001:~# condor_q

-- Schedd: DataCenterCompute001 : <10.0.4.243:1439?... @ 08/14/24 20:39:22
OWNER BATCH_NAME      SUBMITTED   DONE   RUN    IDLE   HOLD  TOTAL JOB_IDS

Total for query: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for condor: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for all users: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended

root@DataCenterCompute001:~# condor_status
Name                      OpSys      Arch   State     Activity LoadAv Mem    ActvtyTime

slot1@AgronomyFarmEdge000 LINUX      X86_64 Unclaimed Idle      0.000 63852  0+00:00:00

               Total Owner Claimed Unclaimed Matched Preempting  Drain Backfill BkIdle

  X86_64/LINUX     1     0       0         1       0          0      0        0      0

         Total     1     0       0         1       0          0      0        0      0
root@DataCenterCompute001:~#
```

Now what what needs to be customized? These are what the overly simplifed configs look like now ...

```
root@DataCenterCompute000:/etc/condor/config.d# cat 01-central-manager.config 
CONDOR_HOST = 10.0.4.242
# For details, run condor_config_val use role:get_htcondor_central_manager
use role:get_htcondor_central_manager
root@DataCenterCompute000:/etc/condor/config.d#
```
```
root@DataCenterCompute000:/etc/condor/config.d# condor_config_val use role:get_htcondor_central_manager
use ROLE:get_htcondor_central_manager is
use security:get_htcondor_idtokens

use role:CentralManager
root@DataCenterCompute000:/etc/condor/config.d#
```

```
root@DataCenterCompute001:~# cat /etc/condor/config.d/01-submit.config 
CONDOR_HOST = 10.0.4.242
# For details, run condor_config_val use role:get_htcondor_submit
use role:get_htcondor_submit
root@DataCenterCompute001:~#
```
```
root@DataCenterCompute001:~# condor_config_val use role:get_htcondor_submit
use ROLE:get_htcondor_submit is
use security:get_htcondor_idtokens

# Allow local users to submit jobs.  Since the only way to authenticate
# is with IDTOKENS (all of whose holders we trust) and FS (the local users),
# we can avoid writing things like *@$(HOSTNAME), which will fail if
# UID_DOMAIN is set (and introduces more opportunities for DNS to fail).
ALLOW_WRITE = $(ALLOW_WRITE) *

use role:submit
root@DataCenterCompute001:~#
```


```
root@AgronomyFarmEdge000:~# cat /etc/condor/config.d/01-execute.config 
CONDOR_HOST = 10.0.4.242
# For details, run condor_config_val use role:get_htcondor_execute
use role:get_htcondor_execute
root@AgronomyFarmEdge000:~#
```

```
root@AgronomyFarmEdge000:~# condor_config_val use role:get_htcondor_execute
use ROLE:get_htcondor_execute is
use security:get_htcondor_idtokens

use role:execute
root@AgronomyFarmEdge000:~#
```

Job submission and running!

```
icicle@DataCenterCompute001:~$ pwd
/home/icicle
icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:47:20
OWNER BATCH_NAME      SUBMITTED   DONE   RUN    IDLE   HOLD  TOTAL JOB_IDS

Total for query: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for icicle: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for all users: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ vi bash_pi.htcondor
icicle@DataCenterCompute001:~$ vi bash_pi.sh
icicle@DataCenterCompute001:~$ condor_submit bash_pi.htcondor 
Submitting job(s)........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
1000 job(s) submitted to cluster 1.
icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:48:55
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _      _   1000   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 1000 idle, 0 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 1000 idle, 0 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 1000 idle, 0 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:49:10
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _     48    952   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:49:12
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _     48    952   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:49:49
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _     48    952   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:49:51
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _     48    952   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:49:52
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _     48    952   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 952 idle, 48 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$ condor_status
Name                         OpSys      Arch   State     Activity LoadAv Mem    ActvtyTime

slot1@AgronomyFarmEdge000    LINUX      X86_64 Unclaimed Idle      0.000 35180  0+00:13:32
slot1_1@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_2@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_3@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_4@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_5@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_6@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_7@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_8@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_9@AgronomyFarmEdge000  LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_10@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_11@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_12@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_13@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_14@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_15@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_16@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_17@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_18@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_19@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_20@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_21@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_22@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_23@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_24@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_25@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_26@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Busy      0.000  1024  0+00:00:01
slot1_27@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Idle      0.000  1024  0+00:00:01
slot1_28@AgronomyFarmEdge000 LINUX      X86_64 Claimed   Idle      0.000  1024  0+00:00:00

               Total Owner Claimed Unclaimed Matched Preempting  Drain Backfill BkIdle

  X86_64/LINUX    29     0      28         1       0          0      0        0      0

         Total    29     0      28         1       0          0      0        0      0
icicle@DataCenterCompute001:~$
```

The compute load from this simple job appears to be causing problem on the edge node ... waiting a long time for `top` to return ..

And now booted from container ... 

```
root@AgronomyFarmEdge000:~# top
Connection to 10.189.10.44 closed by remote host.
mckandes@ara-jbox:~$
```

... but everything seems to be running fine. Maybe I requested too much memory? Or hypertreading may be problem? Jobs restarted?

```
icicle@DataCenterCompute001:~$ condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:9618?... @ 08/14/24 20:57:08
OWNER  BATCH_NAME    SUBMITTED   DONE   RUN    IDLE  TOTAL JOB_IDS
icicle ID: 1        8/14 20:48      _      9    991   1000 1.0-999

Total for query: 1000 jobs; 0 completed, 0 removed, 991 idle, 9 running, 0 held, 0 suspended 
Total for icicle: 1000 jobs; 0 completed, 0 removed, 991 idle, 9 running, 0 held, 0 suspended 
Total for all users: 1000 jobs; 0 completed, 0 removed, 991 idle, 9 running, 0 held, 0 suspended

icicle@DataCenterCompute001:~$
```

Bingo!

```
icicle@DataCenterCompute001:~$ cat bash_pi.log.1.0
000 (001.000.000) 2024-08-14 20:48:52 Job submitted from host: <10.0.4.243:9618?addrs=10.0.4.243-9618&alias=DataCenterCompute001&noUDP&sock=schedd_13041_ef11>
...
040 (001.000.000) 2024-08-14 20:49:01 Started transferring input files
	Transferring to host: <10.0.4.244:9618?addrs=10.0.4.244-9618&alias=AgronomyFarmEdge000&noUDP&sock=slot1_1_13045_21ec_7>
...
040 (001.000.000) 2024-08-14 20:49:01 Finished transferring input files
...
001 (001.000.000) 2024-08-14 20:49:02 Job executing on host: <10.0.4.244:9618?addrs=10.0.4.244-9618&alias=AgronomyFarmEdge000&noUDP&sock=startd_13011_5b39>
	SlotName: slot1_1@AgronomyFarmEdge000
	CondorScratchDir = "/var/lib/condor/execute/dir_13167"
	Cpus = 1
	Disk = 4335
	GPUs = 0
	Memory = 1024
...
006 (001.000.000) 2024-08-14 20:53:55 Image size of job updated: 15824
	15  -  MemoryUsage of job (MB)
	15060  -  ResidentSetSize of job (KB)
...
021 (001.000.000) 2024-08-14 20:54:51 Error from starter on slot1_1@AgronomyFarmEdge000:
	Worker node is out of memory
...
004 (001.000.000) 2024-08-14 20:54:55 Job was evicted.
	(0) CPU times
		Usr 0 00:00:00, Sys 0 00:01:04  -  Run Remote Usage
		Usr 0 00:00:00, Sys 0 00:00:00  -  Run Local Usage
	0  -  Run Bytes Sent By Job
	1527  -  Run Bytes Received By Job
	Error from slot1_1@AgronomyFarmEdge000: Worker node is out of memory
	Partitionable Resources :    Usage  Request Allocated 
	   Cpus                 :        0        1         1 
	   Disk (KB)            :       17        2      4335 
	   GPUs                 :                           0 
	   Memory (MB)          :       15     1024      1024 
	   TimeSlotBusy (s)     :      350                    
...
icicle@DataCenterCompute001:~$
```

## Dual-Use Roles

It looks like it's fairly simple to swap in roles for dual-use configurations.

```
root@DataCenterCompute001:~# cat /etc/condor/config.d/01-submit-worker.config 
CONDOR_HOST = 10.0.4.242
# For details, run condor_config_val use role:get_htcondor_submit
use role:get_htcondor_submit
use role:get_htcondor_execute
root@DataCenterCompute001:~# condor_q


-- Schedd: DataCenterCompute001 : <10.0.4.243:11473?... @ 08/15/24 04:39:54
OWNER BATCH_NAME      SUBMITTED   DONE   RUN    IDLE   HOLD  TOTAL JOB_IDS

Total for query: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for condor: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended 
Total for all users: 0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended

root@DataCenterCompute001:~# condor_status
Name                       OpSys      Arch   State     Activity LoadAv Mem     ActvtyTime

slot1@DataCenterCompute001 LINUX      X86_64 Unclaimed Idle      0.000 386400  0+00:00:00

               Total Owner Claimed Unclaimed Matched Preempting  Drain Backfill BkIdle

  X86_64/LINUX     1     0       0         1       0          0      0        0      0

         Total     1     0       0         1       0          0      0        0      0
root@DataCenterCompute001:~# cat /etc/condor/config.d/01-submit-worker.config 
CONDOR_HOST = 10.0.4.242
# For details, run condor_config_val use role:get_htcondor_submit
use role:get_htcondor_submit
use role:get_htcondor_execute
root@DataCenterCompute001:~#
```
