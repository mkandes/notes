# AraFest 24: Automation with Heat Orchestration Templates

- [ARA Portal](https://portal.arawireless.org)
- [ARA User Manual](https://arawireless.readthedocs.io/en/latest)
- [Heat Orchestration Template (HOT) Guide](https://docs.openstack.org/heat/latest/template_guide/index.html)


###  HOT from [ARA Edge Usage Experiment](https://arawireless.readthedocs.io/en/latest/ara_experiments/additional_experiments/ara_edge_experiment.html#ara-edge-experiment)
```
heat_template_version: '2015-04-30'
resources:
  lease_0:
    type: OS::Blazar::Lease
    properties:
      start_date: ''
      end_date: ''
      name: AgronomyFarmEdge000
      reservations:
      - resource_properties:
        - Site: AgronomyFarm
          Resource_Type: ComputeNode
          Device_Type: Edge
          Device_ID: '000'
  container_0:
    type: OS::Zun::Container
    depends_on:
    - lease_0
    properties:
      command: /bin/bash
      cpu: 16.0
      memory: '8192'
      image: arawirelesshub/ara-edge:base
      name: AgronomyFarmEdge000
      hints:
        host_name: AgronomyFarm-Edge-000
      networks:
      - network: ARA_Shared_Net
```

### Modified HOT from [ARA Edge Usage Experiment](https://arawireless.readthedocs.io/en/latest/ara_experiments/additional_experiments/ara_edge_experiment.html#ara-edge-experiment) to Inject SSH Public Key with `str_replace` function

```
heat_template_version: '2015-04-30'
resources:
  lease_0:
    type: OS::Blazar::Lease
    properties:
      start_date: ''
      end_date: ''
      name: AgronomyFarmEdge000
      reservations:
      - resource_properties:
        - Site: AgronomyFarm
          Resource_Type: ComputeNode
          Device_Type: Edge
          Device_ID: '000'
  container_0:
    type: OS::Zun::Container
    depends_on:
    - lease_0
    properties:
      command: /bin/bash
      cpu: 16.0
      memory: '8192'
      image: arawirelesshub/ara-edge:base
      name: AgronomyFarmEdge000
      hints:
        host_name: AgronomyFarm-Edge-000
      networks:
      - network: ARA_Shared_Net
      command:
        str_replace:
          template: /bin/bash -c >-"
            mkdir -p /root/.ssh;
            echo 'SSH_PUBLIC_KEY' > /root/.ssh/authorized_keys;
            service ssh restart;
            /bin/bash;"
      params:
            SSH_PUBLIC_KEY: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDSzjVQxM3vWDsGp9qiZl9bB9VOcj0uaIidaaygSoDZ3x7sDOwX54OKQZITR6n62So0JDFSHP6clu5ZMqqXxD904ngKQUcWjC5RCklhTg0YgYWUTSCJcbn664/YPSr6Nopl5uentRm9r8dGUlA6i5tdRmJntpt8oWXDDNR+bYdRv956FBTYoP+Q0whweiNv4YjTNMu5ZkKEXR5zwj+VULSzz4Ra5GdM9On6bXL9zUC/vr+MYZTy86Xsu9Zx1GkPwhjNqQT0CafziyvYVFONljBBZ3EUpoV5VnQaYtvIJ3+oTzOLAeT1ToLp7gqO+nAknhXQMKauNIN18AAgZ0BC1+GT2ql2FWrbJ92QqWLtaBXeJ9DWjUX2AimBClRv2glqqtYIJF8E/nU8l6JuKQO3DXtohTb4IrZKKivPfGdBBiXW3Uo9Do6DZtCp7ju5LYThoYfPel5ZOiMlbY23WZXck9IJqaDbNK4jcu8vvrc+N9J3LG3V1uJY1+trU9NIZxsz4FMpbVu1FvzhonsTVf13826oW56CsSKPhhsSF8v/iwg82DlXnz0WKtsTRB0PRlnHGEssBDNvCqn8OPeBRXzdp038Qz6SsKIGOZcVoUod9xuQpCMApyPwBcGt5E2JP/KUHEHU95a/pljidYJYj/MtbCrgP92+msEBh7l+BffaL8Ps3Q== mkandes@hardtack
```

### Mo
