# Deploying sdsc-0.21.2 on Expanse

At the start of this upgrade, the [`sdsc/spack`](https://github.com/sdsc/spack/) repository is still set to default to the `sdsc-0.17.3` deployment branch. As such, the first step in this upgrade and deployment process will be to change the default branch of the repository to `sdsc-0.21.2`. Here is the link to the GitHub documentation on [how to change the default branch](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-branches-in-your-repository/changing-the-default-branch). I will summarize the key steps below.

### Changing the default branch

1. Navigate to the [`sdsc/spack`](https://github.com/sdsc/spack/) repository.
2. Under the repository name, click on the **Settings** tab on the right-hand side of the main navigation bar. If the **Settings** tab is not currently visible due to the size of your browser windwow, then select it from the $\\cdots{}$ dropdown menu, which should also be located on the right-hand side of the main navigation bar.
3. Under the *Default Branch* section, click on the **Switch to another branch** option, which is the second button on the right from the default branch name.
4. Select the new default branch from the dropdown menu: `sdsc-0.21.2`
5. Click **Update**.
6. Read the warning message: *Changing your default branch can have unintended consequences that can affect new pull requests and clones.*
7. Acknowledge the change and click **I understand, update the default branch**. 

### Resync a fork after change of default branch upstream

With the default branch now set to `sdsc-0.21.2` on [`sdsc/spack`](https://github.com/sdsc/spack/), let's see if we can update the default branch on a fork without using the GitHub web interface. I don't think this will be possible. But at the very least, we'll resynchronize my personal fork [`mkandes/spack`](https://github.com/mkandes/spack) with [`sdsc/spack`](https://github.com/sdsc/spack/). 

```
[mkandes@login01 spack]$ pwd
/home/mkandes/software/spack/repos/mkandes/spack
[mkandes@login01 spack]$ git branch
  sdsc-0.17.3
* sdsc-0.17.3-gh-133-pkg-spec-exp-cpu-bamutil
[mkandes@login01 spack]$ git checkout sdsc-0.17.3
Switched to branch 'sdsc-0.17.3'
Your branch is up to date with 'origin/sdsc-0.17.3'.
[mkandes@login01 spack]$ git branch -rvv
  origin/HEAD                                        -> origin/sdsc-0.17.3
  origin/develop                                     2c36a8aac3 new package: msr-safe (#46289)
  origin/sdsc-0.17.3                                 2189d0514e Merge pull request #132 from mkandes/sdsc-0.17.3-gh-124-inst-exp-gpu-dev
  origin/sdsc-0.17.3-gh-124-inst-exp-cpu-dev         0691353b10 Update deploy.sh and aocc@3.2.0 % gcc@8.5.0 for exp/0.17.3/cpu/dev
  origin/sdsc-0.17.3-gh-124-inst-exp-gpu-dev         240178753a Update deploy.sh for exp/0.17.3/gpu/dev
  origin/sdsc-0.17.3-gh-125-spec-exp-cpu-pgi-netcdf  2eccf08949 Add nvhpc@21.9 % gcc@8.5.0 + netcdf-* to exp/0.17.3/cpu/b
  origin/sdsc-0.17.3-gh-127-spec-exp-cpu-intel-tbb   8cac7a7b4b Add intel-tbb@2020.3 % intel@19.1.3.304 to exp/0.17.3/cpu/b
  origin/sdsc-0.17.3-gh-129-pkg-spec-exp-cpu-star    799e7ded9b Add star@2.7.11b % gcc@10.2.0 to exp/0.17.3/cpu/b
  origin/sdsc-0.17.3-gh-133-pkg-spec-exp-cpu-bamutil 763f9727ad Add bamutil@1.0.15 % gcc@10.2.0 to expanse/0.17.3/cpu/b
[mkandes@login01 spack]$ git branch -a
* sdsc-0.17.3
  sdsc-0.17.3-gh-133-pkg-spec-exp-cpu-bamutil
  remotes/origin/HEAD -> origin/sdsc-0.17.3
  remotes/origin/develop
  remotes/origin/sdsc-0.17.3
  remotes/origin/sdsc-0.17.3-gh-124-inst-exp-cpu-dev
  remotes/origin/sdsc-0.17.3-gh-124-inst-exp-gpu-dev
  remotes/origin/sdsc-0.17.3-gh-125-spec-exp-cpu-pgi-netcdf
  remotes/origin/sdsc-0.17.3-gh-127-spec-exp-cpu-intel-tbb
  remotes/origin/sdsc-0.17.3-gh-129-pkg-spec-exp-cpu-star
  remotes/origin/sdsc-0.17.3-gh-133-pkg-spec-exp-cpu-bamutil
[mkandes@login01 spack]$
```
