# Continue the development of headless VNC containers

```
ubuntu@vnc-dev-u22:~$ vncserver -localhost -geometry 800x600 -depth 32

New Xtigervnc server 'vnc-dev-u22.js2local:1 (ubuntu)' on port 5901 for display :1.
Use xtigervncviewer -SecurityTypes VncAuth -passwd /home/ubuntu/.vnc/passwd :1 to connect to the VNC server.

ubuntu@vnc-dev-u22:~$ pgrep Xtigervnc
7658
ubuntu@vnc-dev-u22:~$ ss -tulpn | grep -E -i 'vnc|590'
tcp   LISTEN 0      5                127.0.0.1:5901       0.0.0.0:*    users:(("Xtigervnc",pid=7658,fd=9)) 
tcp   LISTEN 0      5                    [::1]:5901          [::]:*    users:(("Xtigervnc",pid=7658,fd=10))
ubuntu@vnc-dev-u22:~$
```

```
mkandes@hardtack:~$ ssh ubuntu@149.165.154.129 -L 5901:127.0.0.1:5901

 System information as of Thu Oct 30 15:36:53 UTC 2025

  System load:  0.01               Processes:               219
  Usage of /:   41.0% of 57.97GB   Users logged in:         0
  Memory usage: 44%                IPv4 address for enp1s0: 10.0.113.109
  Swap usage:   0%

══════════════════════════https://jetstream.status.io/══════════════════════════

Overall Jetstream2 Status:   Operational 



════════════════════════════════════════════════════════════════════════════════

Last login: Thu Oct 30 03:15:53 2025 from 216.15.51.171
ubuntu@js2-perfsonar-archive:~$ channel 3: open failed: connect failed: Connection refused
channel 3: open failed: connect failed: Connection refused
channel 3: open failed: connect failed: Connection refused
channel 3: open failed: connect failed: Connection refused
channel 3: open failed: connect failed: Connection refused
^C
ubuntu@js2-perfsonar-archive:~$
```

```
mkandes@hardtack:~$ ssh ubuntu@149.165.159.173 -L 5901:127.0.0.1:5901

 System information as of Thu Oct 30 03:38:22 PM UTC 2025

  System load:  0.0                Processes:               334
  Usage of /:   18.6% of 57.97GB   Users logged in:         1
  Memory usage: 3%                 IPv4 address for enp1s0: 10.0.113.100
  Swap usage:   0%

══════════════════════════https://jetstream.status.io/══════════════════════════

Overall Jetstream2 Status:   Operational 



════════════════════════════════════════════════════════════════════════════════

Last login: Thu Oct 30 02:38:57 2025 from 216.15.51.171
ubuntu@vnc-dev-u22:~$
```

Success! However, I guess need to set user `passwd` to login.

```
ubuntu@vnc-dev-u22:~$ sudo passwd ubuntu
New password: 
Retype new password: 
passwd: password updated successfully
ubuntu@vnc-dev-u22:~$
```

Now, can we replicate when running from within a container?

```
mkandes@hardtack:~$ ssh ubuntu@149.165.159.173
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ED25519 key sent by the remote host is
SHA256:39khT5QP2GHO6G7Ja1iNOxRZ90+Vuu0lZktQ249ihf0.
Please contact your system administrator.
Add correct host key in /home/mkandes/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /home/mkandes/.ssh/known_hosts:48
  remove with:
  ssh-keygen -f '/home/mkandes/.ssh/known_hosts' -R '149.165.159.173'
Host key for 149.165.159.173 has changed and you have requested strict checking.
Host key verification failed.
mkandes@hardtack:~$ ssh-keygen -f '/home/mkandes/.ssh/known_hosts' -R '149.165.159.173'
# Host 149.165.159.173 found: line 46
# Host 149.165.159.173 found: line 47
# Host 149.165.159.173 found: line 48
/home/mkandes/.ssh/known_hosts updated.
Original contents retained as /home/mkandes/.ssh/known_hosts.old
mkandes@hardtack:~$ ssh ubuntu@149.165.159.173
The authenticity of host '149.165.159.173 (149.165.159.173)' can't be established.
ED25519 key fingerprint is SHA256:39khT5QP2GHO6G7Ja1iNOxRZ90+Vuu0lZktQ249ihf0.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '149.165.159.173' (ED25519) to the list of known hosts.

 System information as of Thu Oct 30 16:12:13 UTC 2025

  System load:  0.0               Processes:               223
  Usage of /:   9.4% of 57.97GB   Users logged in:         0
  Memory usage: 1%                IPv4 address for enp1s0: 10.0.113.183
  Swap usage:   0%

══════════════════════════https://jetstream.status.io/══════════════════════════

Overall Jetstream2 Status:   Operational 



════════════════════════════════════════════════════════════════════════════════

ubuntu@container-builder:~$
```

```
ubuntu@container-builder:~$ sudo -i
root@container-builder:~# export MIRRORURL='https://us.archive.ubuntu.com/ubuntu'
root@container-builder:~# export OSVERSION='jammy'
root@container-builder:~# export ARCH='amd64'
root@container-builder:~# export LC_ALL='C'
root@container-builder:~# export DEBIAN_FRONTEND='noninteractive'
root@container-builder:~# apt-get -y install ubuntu-server
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
ubuntu-server is already the newest version (1.481.4).
0 upgraded, 0 newly installed, 0 to remove and 5 not upgraded.
root@container-builder:~#
```

```
root@container-builder:~# add-apt-repository -y "deb ${MIRRORURL} ${OSVERSION} main"
Repository: 'deb https://us.archive.ubuntu.com/ubuntu jammy main'
Description:
Archive for codename: jammy components: main
More info: https://us.archive.ubuntu.com/ubuntu
Adding repository.
Found existing deb entry in /etc/apt/sources.list
Updating existing entry instead of using /etc/apt/sources.list.d/archive_uri-https_us_archive_ubuntu_com_ubuntu-jammy.list
Found existing deb-src entry in /etc/apt/sources.list.d/archive_uri-https_us_archive_ubuntu_com_ubuntu-jammy.list
Updating existing entry instead of using /etc/apt/sources.list
Hit:1 https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64  InRelease
Hit:2 https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64  InRelease
Hit:3 https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64  InRelease      
Hit:4 http://security.ubuntu.com/ubuntu jammy-security InRelease               
Hit:5 https://download.ceph.com/debian-reef jammy InRelease                    
Hit:6 https://us.archive.ubuntu.com/ubuntu jammy InRelease                     
Hit:7 http://nova.clouds.archive.ubuntu.com/ubuntu jammy InRelease             
Hit:9 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:11 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-backports InRelease
Hit:8 https://packagecloud.io/dcommander/turbovnc/any any InRelease
Hit:10 https://packagecloud.io/dcommander/virtualgl/any any InRelease
Reading package lists... Done
W: https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://download.ceph.com/debian-reef/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
root@container-builder:~# add-apt-repository -y "deb ${MIRRORURL} ${OSVERSION} universe"
...
root@container-builder:~# add-apt-repository -y "deb ${MIRRORURL} ${OSVERSION}-security restricted"
Repository: 'deb https://us.archive.ubuntu.com/ubuntu jammy-security restricted'
Description:
Archive for codename: jammy-security components: restricted
More info: https://us.archive.ubuntu.com/ubuntu
Adding repository.
Updating existing entry instead of using /etc/apt/sources.list.d/archive_uri-https_us_archive_ubuntu_com_ubuntu-jammy.list
Updating existing entry instead of using /etc/apt/sources.list
Hit:1 https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64  InRelease
Hit:2 https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64  InRelease             
Hit:3 https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64  InRelease                               
Hit:4 https://download.ceph.com/debian-reef jammy InRelease                                             
Hit:5 https://us.archive.ubuntu.com/ubuntu jammy InRelease                                              
Hit:6 http://nova.clouds.archive.ubuntu.com/ubuntu jammy InRelease                                      
Hit:7 https://us.archive.ubuntu.com/ubuntu jammy-updates InRelease                                      
Hit:8 http://security.ubuntu.com/ubuntu jammy-security InRelease                          
Hit:9 https://us.archive.ubuntu.com/ubuntu jammy-backports InRelease                      
Hit:10 https://us.archive.ubuntu.com/ubuntu jammy-security InRelease
Hit:12 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:14 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-backports InRelease
Hit:11 https://packagecloud.io/dcommander/turbovnc/any any InRelease
Hit:13 https://packagecloud.io/dcommander/virtualgl/any any InRelease
Get:15 https://us.archive.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [4623 kB]
Get:16 https://us.archive.ubuntu.com/ubuntu jammy-security/restricted Translation-en [859 kB]
Get:17 https://us.archive.ubuntu.com/ubuntu jammy-security/restricted amd64 c-n-f Metadata [652 B]
Fetched 5483 kB in 2s (2456 kB/s)               
Reading package lists... Done
W: https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://download.ceph.com/debian-reef/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
root@container-builder:~#
```

```
root@container-builder:~# apt-get -y update && apt-get -y upgrade
Hit:1 https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64  InRelease
Hit:2 https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64  InRelease             
Hit:3 https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64  InRelease                               
Hit:4 https://download.ceph.com/debian-reef jammy InRelease                                             
Hit:5 https://us.archive.ubuntu.com/ubuntu jammy InRelease                                              
Hit:6 http://nova.clouds.archive.ubuntu.com/ubuntu jammy InRelease                                      
Hit:7 https://us.archive.ubuntu.com/ubuntu jammy-updates InRelease                                      
Hit:8 https://us.archive.ubuntu.com/ubuntu jammy-backports InRelease                      
Hit:9 https://us.archive.ubuntu.com/ubuntu jammy-security InRelease                       
Hit:10 http://security.ubuntu.com/ubuntu jammy-security InRelease   
Hit:12 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:14 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-backports InRelease
Hit:11 https://packagecloud.io/dcommander/turbovnc/any any InRelease
Hit:13 https://packagecloud.io/dcommander/virtualgl/any any InRelease
Reading package lists... Done
W: https://nvidia.github.io/libnvidia-container/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-container-runtime/stable/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://nvidia.github.io/nvidia-docker/ubuntu18.04/amd64/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
W: https://download.ceph.com/debian-reef/dists/jammy/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following packages have been kept back:
  linux-generic-hwe-22.04 linux-headers-generic-hwe-22.04 linux-image-generic-hwe-22.04
The following packages will be upgraded:
  linux-libc-dev linux-tools-common
2 upgraded, 0 newly installed, 0 to remove and 3 not upgraded.
Need to get 1585 kB of archives.
After this operation, 2048 B of additional disk space will be used.
Get:1 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-updates/main amd64 linux-libc-dev amd64 5.15.0-161.171 [1307 kB]
Get:2 http://nova.clouds.archive.ubuntu.com/ubuntu jammy-updates/main amd64 linux-tools-common all 5.15.0-161.171 [278 kB]
Fetched 1585 kB in 1s (1501 kB/s)          
(Reading database ... 85723 files and directories currently installed.)
Preparing to unpack .../linux-libc-dev_5.15.0-161.171_amd64.deb ...
Unpacking linux-libc-dev:amd64 (5.15.0-161.171) over (5.15.0-160.170) ...
Preparing to unpack .../linux-tools-common_5.15.0-161.171_all.deb ...
Unpacking linux-tools-common (5.15.0-161.171) over (5.15.0-160.170) ...
Setting up linux-libc-dev:amd64 (5.15.0-161.171) ...
Setting up linux-tools-common (5.15.0-161.171) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...                                                                                    
Scanning candidates...                                                                                   
Scanning linux images...                                                                                 

Running kernel seems to be up-to-date.

Services to be restarted:
 systemctl restart packagekit.service

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
root@container-builder:~#
```


# Reference(s):
- https://github.com/ConSol/docker-headless-vnc-container
- https://github.com/accetto/ubuntu-vnc-xfce-g3
- https://tigervnc.org/
- https://novnc.com/
- https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-vnc-on-ubuntu-22-04
- https://docs.jetstream-cloud.org/ui/exo/gpu-desktop/
- https://www.cyberciti.biz/faq/install-and-configure-tigervnc-server-on-ubuntu-18-04/
- https://askubuntu.com/questions/1375111/vncserver-exited-too-early
