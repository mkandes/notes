# Using the Mac OS X built-in VNC Client to connect to a headless VNC server running on Expanse

1. In the Finder , open the `/Applications/Utilities` folder, then double-click `Terminal`.
2. Once the `Terminal` window is open, login to Expanse via SSH and submit an interactive job with the resources you want to use.
   ```
   mkandes@hardtack:~$ ssh login.expanse.sdsc.edu
   (mkandes@login.expanse.sdsc.edu) TOTP code for mkandes: 672579
   Welcome to Bright release         9.0

                                                         Based on Rocky Linux 8
                                                                    ID: #000002

   --------------------------------------------------------------------------------

                                 WELCOME TO
                  _______  __ ____  ___    _   _______ ______
                 / ____/ |/ // __ \/   |  / | / / ___// ____/
                / __/  |   // /_/ / /| | /  |/ /\__ \/ __/
               / /___ /   |/ ____/ ___ |/ /|  /___/ / /___
              /_____//_/|_/_/   /_/  |_/_/ |_//____/_____/

   --------------------------------------------------------------------------------

   Use the following commands to adjust your environment:

   'module avail'            - show available modules
   'module add <module>'     - adds a module to your environment for this session
   'module initadd <module>' - configure module to be loaded at every login

   -------------------------------------------------------------------------------
   Last login: Thu Nov 13 11:06:43 2025 from 216.15.51.171
   [mkandes@login01 ~]$
   [mkandes@login01 ~]$ srun --partition=debug --account=use300 --nodes=1 --ntasks-per-node=1 --cpus-per-task=8 --mem=16G --time=00:30:00 --wait=0 --pty /bin/bash
   srun: job 44152403 queued and waiting for resources
   srun: job 44152403 has been allocated resources
   [mkandes@exp-9-55 ~]$
   ```
3. Load the `singularitypro` module and then `shell` into the `tigervnc` container.
   ```
   [mkandes@exp-9-55 ~]$ module load singularitypro
   [mkandes@exp-9-55 ~]$ singularity shell oras://ghcr.io/mkandes/tigervnc:latest-amd64
   INFO:    Using cached SIF image
   Singularity>
   ```
4. Once inside the contaner, set your `vncpasswd`.
   ```
   Singularity> vncpasswd
   Password:
   Verify:
   Would you like to enter a view-only password (y/n)? n
   A view-only password is not used
   Singularity>
   ```
6. After your password is set, create the `xstartup` file and set its permissions to be executable.
   ```
   Singularity> vi ~/.vnc/xstartup
   Singularity> cat ~/.vnc/xstartup
   #!/bin/sh
   [ -x /etc/vnc/xstartup ] && exec /etc/vnc/xstartup
   [ -r $HOME/.Xresources ] && xrdb $HOME/.Xresources
   vncconfig -iconic &
   dbus-launch --exit-with-session startxfce4
   Singularity> chmod +x ~/.vnc/xstartup 
   Singularity>
   ```
8. Now try and start the `vncserver`.
   ```
   Singularity> vncserver -localhost -geometry 800x600 -depth 32

   New Xtigervnc server 'exp-9-55.expanse.sdsc.edu:1 (mkandes)' on port 5901 for display :1.
   Use xtigervncviewer -SecurityTypes VncAuth -passwd /home/mkandes/.vnc/passwd :1 to connect to the VNC server.

   Singularity>
   ```
10. If the server starts up successfully, open a second `Terminal` window and create an SSH tunnel with local port forwarding to the compute node on Expanse where the `vncserver` is running.
    ```
    mkandes@hardtack:~$ ssh mkandes@exp-9-55.expanse.sdsc.edu -L 5901:127.0.0.1:5901
    (mkandes@exp-9-55.expanse.sdsc.edu) TOTP code for mkandes: 745614
    Last login: Thu Sep 25 10:01:51 2025 from 10.21.0.19
    [mkandes@exp-9-55 ~]$
    ```
12. ...
