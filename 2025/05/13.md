# Deploying spack-0.21.2 on Expanse: Part V

```
[spack_cpu@login02 ~]$ squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          39204093 ind-share openfoam spack_cp PD       0:00      1 (Dependency)
          39204092 ind-share scotch@7 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204091 ind-share raxml-ng spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204090 ind-share raxml@8. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204089 ind-share zoltan@3 spack_cp PD       0:00      1 (Dependency)
          39204088 ind-share parmetis spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204087 ind-share wps@4.6. spack_cp PD       0:00      1 (Dependency)
          39204086 ind-share wrf@4.6. spack_cp PD       0:00      1 (Dependency)
          39204085 ind-share netcdf-f spack_cp PD       0:00      1 (Dependency)
          39204084 ind-share netcdf-c spack_cp PD       0:00      1 (Dependency)
          39204083 ind-share netcdf-c spack_cp PD       0:00      1 (Dependency)
          39204082 ind-share ior@3.3. spack_cp PD       0:00      1 (Dependency)
          39204081 ind-share parallel spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204080 ind-share osu-micr spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204079 ind-share quantum- spack_cp PD       0:00      1 (Dependency)
          39204078 ind-share elpa@202 spack_cp PD       0:00      1 (Dependency)
          39204077 ind-share netlib-s spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204076 ind-share neuron@8 spack_cp PD       0:00      1 (Dependency)
          39204075 ind-share adios2@2 spack_cp PD       0:00      1 (Dependency)
          39204074 ind-share py-mpi4p spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204073 ind-share kahip@3. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204072 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204071 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204070 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204069 ind-share  hpl@2.3 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204068 ind-share hdf5@1.1 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204067 ind-share gromacs@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204066 ind-share fftw@3.3 spack_cp PD       0:00      1 (Dependency)
          39204065 ind-share fftw@3.3 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204064 ind-share namd@2.1 spack_cp PD       0:00      1 (Dependency)
          39204063 ind-share charmpp@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204062 ind-share iq-tree@ spack_cp PD       0:00      1 (Dependency)
          39204061 ind-share boost@1. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204060 ind-share amdscala spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204059 ind-share amdfftw@ spack_cp PD       0:00      1 (Dependency)
          39204058 ind-share amdfftw@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
[spack_cpu@login02 ~]$
```

```
[spack_cpu@login02 gcc@13.3.0]$ tail -n 25 openmpi@4.1.8.o39204021.exp-15-56 
==> openssh: Executing phase: 'autoreconf'
==> openssh: Executing phase: 'configure'
==> openssh: Executing phase: 'build'
==> openssh: Executing phase: 'install'
==> openssh: Successfully installed openssh-9.5p1-bcnejstnghftnebyiehhsidor64beahf
  Stage: 0.12s.  Autoreconf: 0.00s.  Configure: 4m 38.45s.  Build: 1m 20.48s.  Install: 3.04s.  Post-install: 4.66s.  Total: 6m 12.43s
[+] /cm/shared/apps/spack/0.21.2/cpu/dev/opt/spack/linux-rocky8-zen2/gcc-13.3.0/openssh-9.5p1-bcnejstnghftnebyiehhsidor64beahf
==> Installing pmix-5.0.1-ukntpodu5a7ejaf4d3adjwmr5ehmhduq [40/41]
==> No binary for pmix-5.0.1-ukntpodu5a7ejaf4d3adjwmr5ehmhduq found: installing from source
==> Fetching https://mirror.spack.io/_source-cache/archive/d4/d4371792d4ba4c791e1010100b4bf9a65500ababaf5ff25d681f938527a67d4a.tar.bz2
==> No patches needed for pmix
==> pmix: Executing phase: 'autoreconf'
==> pmix: Executing phase: 'configure'
==> pmix: Executing phase: 'build'
==> pmix: Executing phase: 'install'
==> pmix: Successfully installed pmix-5.0.1-ukntpodu5a7ejaf4d3adjwmr5ehmhduq
  Stage: 1.05s.  Autoreconf: 0.00s.  Configure: 1m 53.44s.  Build: 2m 18.48s.  Install: 12.00s.  Post-install: 0.20s.  Total: 4m 25.41s
[+] /cm/shared/apps/spack/0.21.2/cpu/dev/opt/spack/linux-rocky8-zen2/gcc-13.3.0/pmix-5.0.1-ukntpodu5a7ejaf4d3adjwmr5ehmhduq
==> Installing openmpi-4.1.8-4ex7oqpa7lqibxo4mkghfmalxwzcefnc [41/41]
==> No binary for openmpi-4.1.8-4ex7oqpa7lqibxo4mkghfmalxwzcefnc found: installing from source
==> Fetching https://mirror.spack.io/_source-cache/archive/46/466f68e3132a1dc02710cc2011fafced8336d98359fa2dae4dddcfd5719f12a9.tar.bz2
==> No patches needed for openmpi
==> openmpi: Executing phase: 'autoreconf'
==> openmpi: Executing phase: 'configure'
==> openmpi: Executing phase: 'build'
[spack_cpu@login02 gcc@13.3.0]$ cd openmpi@4.1.8/
[spack_cpu@login02 openmpi@4.1.8]$ ls
adios2@2.10.1.sh     charmpp@6.10.2.sh    hdf5@1.14.3.sh      ior@3.3.0.sh       netcdf-cxx4@4.3.1.sh       osu-micro-benchmarks@7.4.sh  raxml@8.2.13.sh    zoltan@3.901.sh
amdfftw@4.2-omp.sh   elpa@2024.03.001.sh  hpl@2.3-i64-omp.sh  iq-tree@2.3.6.sh   netcdf-fortran@4.6.1.sh    parallel-netcdf@1.13.0.sh    raxml-ng@1.2.2.sh
amdfftw@4.2.sh       fftw@3.3.10-omp.sh   hpl@2.3-i64.sh      kahip@3.16.sh      netlib-scalapack@2.2.0.sh  parmetis@4.0.3.sh            scotch@7.0.5.sh
amdscalapack@4.2.sh  fftw@3.3.10.sh       hpl@2.3-omp.sh      namd@2.14.sh       neuron@8.2.3.sh            py-mpi4py@4.0.0.sh           wps@4.6.0.sh
boost@1.86.0.sh      gromacs@2024.3.sh    hpl@2.3.sh          netcdf-c@4.9.2.sh  openfoam@2406.sh           quantum-espresso@7.3.1.sh    wrf@4.6.0.sh
[spack_cpu@login02 openmpi@4.1.8]$ pwd
/cm/shared/apps/spack/0.21.2/cpu/dev/etc/spack/sdsc/exp/cpu/dev/specs/gcc@13.3.0/openmpi@4.1.8
[spack_cpu@login02 openmpi@4.1.8]$
```

```
[spack_cpu@login02 gcc@13.3.0]$ head -n 25 openmpi@4.1.8.sh 
#!/usr/bin/env bash

#SBATCH --job-name=openmpi@4.1.8
#SBATCH --account=use300
#SBATCH --reservation=root_73
#SBATCH --clusters=expanse
#SBATCH --partition=ind-shared
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-task=16
#SBATCH --mem=32G
#SBATCH --time=00:30:00
#SBATCH --output=%x.o%j.%N

declare -xir UNIX_TIME="$(date +'%s')"
declare -xr LOCAL_TIME="$(date +'%Y%m%dT%H%M%S%z')"

declare -xr JOB_SCRIPT="$(scontrol show job ${SLURM_JOB_ID} | awk -F= '/Command=/{print $2}')"
declare -xr JOB_SCRIPT_MD5="$(md5sum ${JOB_SCRIPT} | awk '{print $1}')"
declare -xr JOB_SCRIPT_SHA256="$(sha256sum ${JOB_SCRIPT} | awk '{print $1}')"
declare -xr JOB_SCRIPT_NUMBER_OF_LINES="$(wc -l ${JOB_SCRIPT} | awk '{print $1}')"

declare -xr SCHEDULER_NAME='slurm'
declare -xr SCHEDULER_MAJOR='23'
declare -xr SCHEDULER_MINOR='02'
[spack_cpu@login02 gcc@13.3.0]$
```

```
[spack_cpu@login02 ~]$ !7998
srun --partition=ind-shared --reservation=root_73  --account=use300 --nodes=1 --nodelist=exp-15-56 --ntasks-per-node=1 --cpus-per-task=16 --mem=32G --time=12:00:00 --pty --wait=0 /bin/bash
[spack_cpu@exp-15-56 ~]$
```

```
[spack_cpu@exp-15-56 gcc@13.3.0]$ ls
adios2@2.10.1.o39204007.exp-15-56            cgal@4.13.o39204010.exp-15-56         namd@2.14.o39203974.exp-15-56                py-numpy@1.26.4-omp.sh
adios2@2.10.1.sh                             cgal@4.13.sh                          namd@2.14.sh                                 py-numpy@1.26.4.sh
amdblis@4.2-i64.o39203994.exp-15-56          cgal@5.6.1.o39204011.exp-15-56        NAMD_2.14_Source.tar.gz                      py-numpy@2.1.2-i64.o39204013.exp-15-56
amdblis@4.2-i64-omp.o39203998.exp-15-56      cgal@5.6.1.sh                         netcdf-c@4.9.2.o39203980.exp-15-56           py-numpy@2.1.2-i64-omp.o39204015.exp-15-56
amdblis@4.2-i64-omp.sh                       charmpp@6.10.2.o39203966.exp-15-56    netcdf-c@4.9.2.sh                            py-numpy@2.1.2-i64-omp.sh
amdblis@4.2-i64.sh                           charmpp@6.10.2.sh                     netcdf-cxx4@4.3.1.o39203981.exp-15-56        py-numpy@2.1.2-i64.sh
amdblis@4.2.o39203992.exp-15-56              eigen@3.4.0.o39203967.exp-15-56       netcdf-cxx4@4.3.1.sh                         py-numpy@2.1.2.o39204006.exp-15-56
amdblis@4.2-omp.o39203996.exp-15-56          eigen@3.4.0.sh                        netcdf-fortran@4.6.1.o39203982.exp-15-56     py-numpy@2.1.2-omp.o39204014.exp-15-56
amdblis@4.2-omp.sh                           fftw@3.3.10.o39203972.exp-15-56       netcdf-fortran@4.6.1.sh                      py-numpy@2.1.2-omp.sh
amdblis@4.2.sh                               fftw@3.3.10-omp.o39203973.exp-15-56   netlib-lapack@3.12.0.o39203985.exp-15-56     py-numpy@2.1.2.sh
amdfftw@4.2.o39203969.exp-15-56              fftw@3.3.10-omp.sh                    netlib-lapack@3.12.0.sh                      py-pip@24.2.o39204000.exp-15-56
amdfftw@4.2-omp.o39203971.exp-15-56          fftw@3.3.10.sh                        openblas@0.3.28-i64.o39203988.exp-15-56      py-pip@24.2.sh
amdfftw@4.2-omp.sh                           gsl@2.8.o39203975.exp-15-56           openblas@0.3.28-i64-omp.o39203990.exp-15-56  py-setuptools@75.1.0.o39204001.exp-15-56
amdfftw@4.2.sh                               gsl@2.8.sh                            openblas@0.3.28-i64-omp.sh                   py-setuptools@75.1.0.sh
amdlibflame@4.2-i64.o39203995.exp-15-56      hdf5@1.14.3.o39203979.exp-15-56       openblas@0.3.28-i64.sh                       python@3.11.9.o39203991.exp-15-56
amdlibflame@4.2-i64-omp.o39203999.exp-15-56  hdf5@1.14.3.sh                        openblas@0.3.28.o39203986.exp-15-56          python@3.11.9.sh
amdlibflame@4.2-i64-omp.sh                   iq-tree@2.3.6.o39204012.exp-15-56     openblas@0.3.28-omp.o39203989.exp-15-56      py-virtualenv@20.26.5.o39204016.exp-15-56
amdlibflame@4.2-i64.sh                       iq-tree@2.3.6.sh                      openblas@0.3.28-omp.sh                       py-virtualenv@20.26.5.sh
amdlibflame@4.2.o39203993.exp-15-56          libbeagle@3.1.2.o39203977.exp-15-56   openblas@0.3.28.sh                           scotch@7.0.5.o39204017.exp-15-56
amdlibflame@4.2-omp.o39203997.exp-15-56      libbeagle@3.1.2.sh                    openmpi@4.1.8                                scotch@7.0.5.sh
amdlibflame@4.2-omp.sh                       libbeagle@4.0.1.sh                    openmpi@4.1.8.o39204021.exp-15-56            stream@5.10.o39204018.exp-15-56
amdlibflame@4.2.sh                           libxc@6.2.2.o39203976.exp-15-56       openmpi@4.1.8.sh                             stream@5.10-omp.o39204019.exp-15-56
arrayfire@3.9.0.o39204009.exp-15-56          libxc@6.2.2.sh                        py-numpy@1.26.4-i64.o39204003.exp-15-56      stream@5.10-omp.sh
arrayfire@3.9.0.sh                           metis@5.1.0.o39203983.exp-15-56       py-numpy@1.26.4-i64-omp.o39204005.exp-15-56  stream@5.10.sh
beast2@2.7.7.o39203978.exp-15-56             metis@5.1.0.sh                        py-numpy@1.26.4-i64-omp.sh                   ucx@1.14.1.o39204020.exp-15-56
beast2@2.7.7.sh                              mvapich2@2.3.7-2                      py-numpy@1.26.4-i64.sh                       ucx@1.14.1.sh
boost@1.86.0.o39204008.exp-15-56             mvapich2@2.3.7-2.o39203984.exp-15-56  py-numpy@1.26.4.o39204002.exp-15-56
boost@1.86.0.sh                              mvapich2@2.3.7-2.sh                   py-numpy@1.26.4-omp.o39204004.exp-15-56
[spack_cpu@exp-15-56 gcc@13.3.0]$ head -n 25 openmpi@4.1.8.sh 
#!/usr/bin/env bash

#SBATCH --job-name=openmpi@4.1.8
#SBATCH --account=use300
#SBATCH --reservation=root_73
#SBATCH --clusters=expanse
#SBATCH --partition=ind-shared
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-task=16
#SBATCH --mem=32G
#SBATCH --time=01:00:00
#SBATCH --output=%x.o%j.%N

declare -xir UNIX_TIME="$(date +'%s')"
declare -xr LOCAL_TIME="$(date +'%Y%m%dT%H%M%S%z')"

declare -xr JOB_SCRIPT="$(scontrol show job ${SLURM_JOB_ID} | awk -F= '/Command=/{print $2}')"
declare -xr JOB_SCRIPT_MD5="$(md5sum ${JOB_SCRIPT} | awk '{print $1}')"
declare -xr JOB_SCRIPT_SHA256="$(sha256sum ${JOB_SCRIPT} | awk '{print $1}')"
declare -xr JOB_SCRIPT_NUMBER_OF_LINES="$(wc -l ${JOB_SCRIPT} | awk '{print $1}')"

declare -xr SCHEDULER_NAME='slurm'
declare -xr SCHEDULER_MAJOR='23'
declare -xr SCHEDULER_MINOR='02'
[spack_cpu@exp-15-56 gcc@13.3.0]$
```

```
[spack_cpu@exp-15-56 dev]$ ls
deploy.o39203939.exp-15-56  deploy.sh  specs  yamls
[spack_cpu@exp-15-56 dev]$ pwd
/cm/shared/apps/spack/0.21.2/cpu/dev/etc/spack/sdsc/exp/cpu/dev
[spack_cpu@exp-15-56 dev]$ cd ~/scripts/
[spack_cpu@exp-15-56 scripts]$ squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          39204093 ind-share openfoam spack_cp PD       0:00      1 (Dependency)
          39204092 ind-share scotch@7 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204091 ind-share raxml-ng spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204090 ind-share raxml@8. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204089 ind-share zoltan@3 spack_cp PD       0:00      1 (Dependency)
          39204088 ind-share parmetis spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204087 ind-share wps@4.6. spack_cp PD       0:00      1 (Dependency)
          39204086 ind-share wrf@4.6. spack_cp PD       0:00      1 (Dependency)
          39204085 ind-share netcdf-f spack_cp PD       0:00      1 (Dependency)
          39204084 ind-share netcdf-c spack_cp PD       0:00      1 (Dependency)
          39204083 ind-share netcdf-c spack_cp PD       0:00      1 (Dependency)
          39204082 ind-share ior@3.3. spack_cp PD       0:00      1 (Dependency)
          39204081 ind-share parallel spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204080 ind-share osu-micr spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204079 ind-share quantum- spack_cp PD       0:00      1 (Dependency)
          39204078 ind-share elpa@202 spack_cp PD       0:00      1 (Dependency)
          39204077 ind-share netlib-s spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204076 ind-share neuron@8 spack_cp PD       0:00      1 (Dependency)
          39204075 ind-share adios2@2 spack_cp PD       0:00      1 (Dependency)
          39204074 ind-share py-mpi4p spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204073 ind-share kahip@3. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204072 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204071 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204070 ind-share hpl@2.3- spack_cp PD       0:00      1 (Dependency)
          39204069 ind-share  hpl@2.3 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204068 ind-share hdf5@1.1 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204067 ind-share gromacs@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204066 ind-share fftw@3.3 spack_cp PD       0:00      1 (Dependency)
          39204065 ind-share fftw@3.3 spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204064 ind-share namd@2.1 spack_cp PD       0:00      1 (Dependency)
          39204063 ind-share charmpp@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204062 ind-share iq-tree@ spack_cp PD       0:00      1 (Dependency)
          39204061 ind-share boost@1. spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204060 ind-share amdscala spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39204059 ind-share amdfftw@ spack_cp PD       0:00      1 (Dependency)
          39204058 ind-share amdfftw@ spack_cp PD       0:00      1 (DependencyNeverSatisfied)
          39335798 ind-share     bash spack_cp  R       8:50      1 exp-15-56
[spack_cpu@exp-15-56 scripts]$ ./scancel-jobs.sh 
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
[spack_cpu@exp-15-56 scripts]$ slurmstepd: error: *** STEP 39335798.0 ON exp-15-56 CANCELLED AT 2025-05-13T13:50:34 ***
exit
[spack_cpu@login02 ~]$ squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
[spack_cpu@login02 ~]$
```

